(()=>{"use strict";let t="https://tejassrinivasan.pythonanywhere.com/";var e=[];let n=-1,i=null,r=-1,o=-1,s=-1,a=0,u=0,l=0,_=0,c=0,d=0;function h(t){r=t,$("#button_answeronly_usertrusts").attr("disabled","true"),$("#button_answeronly_userdistrusts").attr("disabled","true"),$("#button_answeronly_userunsure").attr("disabled","true"),0==t?$("#button_answeronly_usertrusts").attr("activedecision","true"):1==t?$("#button_answeronly_userdistrusts").attr("activedecision","true"):2==t&&$("#button_answeronly_userunsure").attr("activedecision","true"),$("#ai_explanation_div").show()}function m(t){o=t,$("#button_withexplanation_usertrusts").attr("disabled","true"),$("#button_withexplanation_userdistrusts").attr("disabled","true"),$("#button_withexplanation_userunsure").attr("disabled","true"),0==t?$("#button_withexplanation_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanation_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanation_userunsure").attr("activedecision","true"),"vf_only"!=T&&"vf_contr_both"!=T||("numeric"==k&&$("#vf_numeric_div").show(),"descriptive"==k&&$("#vf_descriptive_div").show()),"contr_only"!=T&&"vf_contr_both"!=T||("numeric"==k&&$("#contr_numeric_div").show(),"descriptive"==k&&$("#contr_descriptive_div").show()),"single_numeric"==T&&(function(t){if(!t)throw"qualityFormat must be numeric for single_numeric"}("numeric"==k),$("#single_numeric_div").show())}function b(t){s=t,$("#button_withexplanationquality_usertrusts").attr("disabled","true"),$("#button_withexplanationquality_userdistrusts").attr("disabled","true"),$("#button_withexplanationquality_userunsure").attr("disabled","true"),0==t?$("#button_withexplanationquality_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanationquality_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanationquality_userunsure").attr("activedecision","true"),$("#button_next").show(),$("#button_next").removeAttr("disabled")}function v(t){return globalThis.noChoicesDataset?`img/${t}_no_choices.png`:`img/${t}.png`}function p(t){c+=t,0==c?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),c>=5?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),6==c&&($("#instructions_and_decorations").show(),$("#main_box_instructions").hide(),$("#main_box_experiment").show(),x()),$("#main_box_instructions").children(":not(input)").each(((t,e)=>{$(e).hide()})),$(`#instructions_${c}`).show(),4==c&&($("#instructions_4").children("div").each(((t,e)=>{$(e).hide()})),"vf_contr_both"==T&&"numeric"==k&&$("#instruction_vf_contr_both_numeric").show(),"vf_only"==T&&"numeric"==k&&$("#instruction_vf_numeric").show(),"contr_only"==T&&"numeric"==k&&$("#instruction_contr_numeric").show(),"single_numeric"==T&&"numeric"==k&&$("#instruction_single_numeric").show(),"vf_contr_both"==T&&"descriptive"==k&&$("#instruction_vf_contr_both_descriptive").show(),"vf_only"==T&&"descriptive"==k&&$("#instruction_vf_descriptive").show(),"contr_only"==T&&"descriptive"==k&&$("#instruction_contr_descriptive").show())}function y(t){let e=0;return e=2==t?0:t==1-i.prediction_is_correct?1:-1,e}function w(t){return 2!=t?t==1-i.prediction_is_correct?1:0:-1}document.getElementById("button_answeronly_usertrusts")?.addEventListener("click",(()=>h(0))),document.getElementById("button_answeronly_userdistrusts")?.addEventListener("click",(()=>h(1))),document.getElementById("button_answeronly_userunsure")?.addEventListener("click",(()=>h(2))),document.getElementById("button_withexplanation_usertrusts")?.addEventListener("click",(()=>m(0))),document.getElementById("button_withexplanation_userdistrusts")?.addEventListener("click",(()=>m(1))),document.getElementById("button_withexplanation_userunsure")?.addEventListener("click",(()=>m(2))),document.getElementById("button_withexplanationquality_usertrusts")?.addEventListener("click",(()=>b(0))),document.getElementById("button_withexplanationquality_userdistrusts")?.addEventListener("click",(()=>b(1))),document.getElementById("button_withexplanationquality_userunsure")?.addEventListener("click",(()=>b(2))),$("#button_instructions_next").on("click",(()=>p(1))),$("#button_instructions_prev").on("click",(()=>p(-1))),$("#button_next").on("click",(()=>{let e=_;if(function(){if(2!=s){let t=1-i.prediction_is_correct;s==t?(_+=.1,a+=1):(_+=-.1,u+=1)}else l+=1}(),-1!=n){let a={question_i:n,user_selections:{answeronly:r,withexplanation:o,withexplanationquality:s},user_is_correct:{answeronly:w(r),withexplanation:w(o),withexplanationquality:w(s)},utility_of_explanation:y(o)-y(r),utility_of_quality_metrics:y(s)-y(o),balance:{old:e,new:_}};a.question=i,a.count_exited_page=d,async function(e){e.url_data=globalThis.url_data,console.log("Data"),"study_id"in e.url_data||(e.url_data.study_id="demo_study"),"prolific_id"in e.url_data||(e.url_data.prolific_id="demo_user"),"session_id"in e.url_data||(e.url_data.session_id="demo_session"),e.url_data.queue_id=globalThis.uid,console.log("logged",e),console.log("Logging to",t+"log");try{let n=await $.ajax(t+"log",{data:JSON.stringify({project:"vlm-rationales-study/"+e.url_data.study_id,uid:globalThis.uid.replace("/","_")+"_"+e.url_data.prolific_id,payload:JSON.stringify(e)}),type:"POST",contentType:"application/json"});return await async function(){return new Promise((t=>setTimeout(t,2e3)))}(),n}catch(t){console.log(t)}}(a),d=0}x()}));let g=null;function f(t,e,n,i){g&&(clearInterval(g),g=null),n.forEach((t=>t.setAttribute("disabled","true")));let r=document.createElement("div");r.id=`timer_${e.id}`,r.style.fontWeight="bold",r.style.marginTop="10px",e.appendChild(r);let o=t;r.textContent=`Please wait ${o} second(s) before making your selection.`,g=setInterval((()=>{o--,o>=0?r.textContent=`Please wait ${o} second(s) before making your selection.`:(null!==g&&(clearInterval(g),g=null),g=null,e.removeChild(r),n.forEach((t=>t.removeAttribute("disabled"))),i&&i())}),1e3)}function x(){if(g&&(clearInterval(g),g=null),$("#button_readytoanswer").removeAttr("activedecision"),$("#button_readytoanswer").removeAttr("disabled"),$("#button_readytoanswer").show(),$("#button_answeronly_usertrusts").removeAttr("activedecision"),$("#button_answeronly_usertrusts").removeAttr("disabled"),$("#button_answeronly_userdistrusts").removeAttr("activedecision"),$("#button_answeronly_userdistrusts").removeAttr("disabled"),$("#button_answeronly_userunsure").removeAttr("activedecision"),$("#button_answeronly_userunsure").removeAttr("disabled"),$("#button_withexplanation_usertrusts").removeAttr("activedecision"),$("#button_withexplanation_usertrusts").removeAttr("disabled"),$("#button_withexplanation_userdistrusts").removeAttr("activedecision"),$("#button_withexplanation_userdistrusts").removeAttr("disabled"),$("#button_withexplanation_userunsure").removeAttr("activedecision"),$("#button_withexplanation_userunsure").removeAttr("disabled"),$("#button_withexplanationquality_usertrusts").removeAttr("activedecision"),$("#button_withexplanationquality_usertrusts").removeAttr("disabled"),$("#button_withexplanationquality_userdistrusts").removeAttr("activedecision"),$("#button_withexplanationquality_userdistrusts").removeAttr("disabled"),$("#button_withexplanationquality_userunsure").removeAttr("activedecision"),$("#button_withexplanationquality_userunsure").removeAttr("disabled"),$("#ai_explanation_div").hide(),$("#ai_explanation_quality_div").hide(),$("#button_next").hide(),$("#button_quit").hide(),n+=1,n>=e.length){$("#main_box_experiment").hide(),_=Math.max(0,_);let t=`Your total reward is <b>$${_.toFixed(2)} + $2</b>.`;return t+=`<br>You answered a total of ${n} questions: ${a} correct, ${u} incorrect, ${l} unsure.`,$("#reward_box").html(t),$("#reward_box").show(),void $("#main_box_end").show()}i=e[n];const t=i.question.replace("Choices:","<br><b>Choices:</b>");$("#question_span").html(t),$("#ai_prediction_span").html(i.predicted_answer),$("#ai_explanation_span").html(i.generated_rationale);let r=Math.round(100*i.visual_fidelity);$("#explanation_fidelity_numeric_span").html(`${r}%`);let o=Math.round(100*i.contrastiveness);$("#explanation_contrastiveness_numeric_span").html(`${o}%`);let s=Math.round((i.visual_fidelity+i.contrastiveness)/2*100);$("#explanation_single_numeric_span").html(`${s}%`);let c="";""==i.reason_vf_correct?c+="<b>There are no details about the image in the explanation that are likely correct.</b>":(c+="<b>Details in the explanation that are likely correct:</b>",c+=i.reason_vf_correct.replace(/<br> -/g,"<br> ✅")),""==i.reason_vf_incorrect?c+="<br><br><b>There are no details about the image in the explanation that are likely incorrect.</b>":(c+="<br><br><b>Details in the explanation that are likely NOT correct:</b>",c+=i.reason_vf_incorrect.replace(/<br> -/g,"<br> ❌")),$("#explanation_fidelity_descriptive_span").html(c);let d="";""==i.reason_contr?d+="<b>None of the other choices are likely correct, based on the explanation.</b>":(d+="<b>Other choices that could be correct, based on the explanation: </b>",d+=i.reason_contr),$("#explanation_contrastiveness_descriptive_span").html(d),$("#progress").text(`Progress: ${n+1} / ${e.length}`),function(t){const e=document.getElementById("ai_answer_div"),n=[document.getElementById("button_answeronly_usertrusts"),document.getElementById("button_answeronly_userdistrusts"),document.getElementById("button_answeronly_userunsure")];function i(){n.forEach((t=>t?.removeEventListener("click",i))),function(t){const e=document.getElementById("ai_explanation_div"),n=t.split(" ").length,i=Math.max(Math.ceil(3+n/238*60),5),r=[document.getElementById("button_withexplanation_usertrusts"),document.getElementById("button_withexplanation_userdistrusts"),document.getElementById("button_withexplanation_userunsure")];function o(){r.forEach((t=>t?.removeEventListener("click",o))),function(){const t=document.getElementById("ai_explanation_quality_div"),e=[document.getElementById("button_withexplanationquality_usertrusts"),document.getElementById("button_withexplanationquality_userdistrusts"),document.getElementById("button_withexplanationquality_userunsure")];function n(){e.forEach((t=>t?.removeEventListener("click",n))),$("#button_next").show()}e.forEach((t=>t?.removeEventListener("click",n))),e.forEach((t=>t?.addEventListener("click",n))),$("#ai_explanation_quality_div").show(),f(5,t,e,null)}()}r.forEach((t=>t?.removeEventListener("click",o))),r.forEach((t=>t?.addEventListener("click",o))),$("#ai_explanation_div").show(),f(i,e,r,null)}(t)}n.forEach((t=>t?.removeEventListener("click",i))),n.forEach((t=>t?.addEventListener("click",i))),$("#ai_answer_div").show(),f(5,e,n,null)}(i.generated_rationale)}document.onvisibilitychange=()=>{document.hidden?(console.log("Window lost focus."),null!==g&&(clearInterval(g),g=null)):console.log("Window regained focus.")};const E=new URLSearchParams(window.location.search),q=E.get("start"),I=E.get("uid");if(globalThis.url_data=function(t){const e={};for(const[n,i]of t)e[n]=i;return e}(E.entries()),null==globalThis.url_data.study_id&&(globalThis.url_data.study_id="demo_study"),null==globalThis.url_data.prolific_id&&(globalThis.url_data.prolific_id="demo_user"),null==globalThis.url_data.session_id&&(globalThis.url_data.session_id="demo_session"),null!=I){if(globalThis.uid=I,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${E.get("prolific_queue_name")}/${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}globalThis.noChoicesDataset=globalThis.uid.includes("vizwiz");let T=E.get("quality_type");if(null==T&&(T="vf_contr_both"),!["vf_only","contr_only","vf_contr_both","single_numeric"].includes(T))throw new Error("Invalid quality type");let k=E.get("quality_format");if(null==k&&(k="numeric"),!["numeric","descriptive"].includes(k))throw new Error("Invalid quality format");globalThis.url_data.explanation_quality_params={quality_type:T,quality_format:k},console.log("Quality params",globalThis.url_data.explanation_quality_params),globalThis.url_data.session_id.startsWith("demo"),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((t=>{e=t,null!=q&&(n=parseInt(q)-1,console.log("Starting from",n)),p(0),$("#img_instr_1").attr("src",v("instructions_1")),$("#img_instr_2").attr("src",v("instructions_2")),$("#img_instr_3").attr("src",v("instructions_3")),$("#img_instr_4_vf_contr_both_numeric").attr("src",v("instructions_4_vf_contr_both_numeric")),$("#img_instr_4_vf_numeric").attr("src",v("instructions_4_vf_numeric")),$("#img_instr_4_contr_numeric").attr("src",v("instructions_4_contr_numeric")),$("#img_instr_4_single_numeric").attr("src",v("instructions_4_single_numeric")),$("#img_instr_4_vf_contr_both_descriptive").attr("src",v("instructions_4_vf_contr_both_descriptive")),$("#img_instr_4_vf_descriptive").attr("src",v("instructions_4_vf_descriptive")),$("#img_instr_4_contr_descriptive").attr("src",v("instructions_4_contr_descriptive")),function(){const t=document.getElementById("reward_instructions");t&&(t.innerHTML=`\n            If your final decision is correct, you gain a reward of $${.1.toFixed(2)}. \n            If your final decision is incorrect, you lose $${Math.abs(-.1).toFixed(2)} from your reward. \n            You will see your total reward at the end of the experiment. \n            Your payment is $2.0 plus whatever you accumulate during this experiment.\n        `)}(),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let A=!1;document.onvisibilitychange=()=>{A||(d+=1,A=!0,globalThis.uid.startsWith("demo")||alert("Please don't leave the page. If you do so again, we may restrict paying you."),A=!1)}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFpQm5ELElBR2pDMkIsRUFBa0IsR0FDbEJkLEVBQUUsZ0JBQWdCQyxLQUFLLE1BQU9TLEVBQVksbUJBQzFDVixFQUFFLGdCQUFnQkMsS0FBSyxNQUFPUyxFQUFZLG1CQUMxQ1YsRUFBRSxnQkFBZ0JDLEtBQUssTUFBT1MsRUFBWSxtQkFDMUNWLEVBQUUsc0NBQ0dDLEtBQUssTUFBT1MsRUFBWSx5Q0FDN0JWLEVBQUUsMkJBQ0dDLEtBQUssTUFBT1MsRUFBWSw4QkFDN0JWLEVBQUUsOEJBQ0dDLEtBQUssTUFBT1MsRUFBWSxpQ0FDN0JWLEVBQUUsK0JBQ0dDLEtBQUssTUFBT1MsRUFBWSxrQ0FDN0JWLEVBQUUsMENBQ0dDLEtBQUssTUFBT1MsRUFBWSw2Q0FDN0JWLEVBQUUsK0JBQ0dDLEtBQUssTUFBT1MsRUFBWSxrQ0FDN0JWLEVBQUUsa0NBQ0dDLEtBQUssTUFBT1MsRUFBWSxxQ0FsZmpDLFdBQ0ksTUFBTWlJLEVBQXFCaEgsU0FBU0MsZUFBZSx1QkFFL0MrRyxJQUNBQSxFQUFtQkMsVUFBWSwwRUN4R1QsR0R5R3dEM0QsUUFBUSxvRUFDakNILEtBQUsrRCxLQ3pHakMsSUR5R3dENUQsUUFBUSxvTUFPakcsQ0F1ZUk2RCxHQUNBOUksRUFBRSwwQkFBMEJFLE9BQzVCRixFQUFFLGlDQUFpQ2lCLE1BQU0sSUE2QjdDb0IsUUFBUUMsSUFBSSw2QkFBOEIxQixXQUFXMkIsS0FFckQsSUFBSXdHLEdBQWUsRUFDbkJwSCxTQUFTK0UsbUJBQXFCLEtBQ3JCcUMsSUFDRGxKLEdBQXFCLEVBQ3JCa0osR0FBZSxFQUNUbkksV0FBVzJCLElBQUt5RixXQUFXLFNBRTlCZ0IsTUFBTSxnRkFFVEQsR0FBZSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2Nvbm5lY3Rvci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZ2xvYmFscy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gY29ubmVjdG9yLnRzXG5pbXBvcnQgeyBERVZNT0RFIH0gZnJvbSAnLi9nbG9iYWxzJ1xuaW1wb3J0IHsgTU9DS01PREUgfSBmcm9tICcuL21haW4nXG5cbmxldCBTRVJWRVJfTE9HX1JPT1QgPSBERVZNT0RFID8gXCJodHRwOi8vMTI3LjAuMC4xOjUwMDAvXCIgOiBcImh0dHBzOi8vdGVqYXNzcmluaXZhc2FuLnB5dGhvbmFueXdoZXJlLmNvbS9cIlxuXG5hc3luYyBmdW5jdGlvbiBzbGVlcChtczogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkX2RhdGEoKTogUHJvbWlzZTxhbnk+IHtcbiAgICAvLyBpbmNsdWRlIHRpbWVzdGFtcCBzbyB0aGF0IHRoaW5ncyBkb24ndCBnZXQgY2FjaGVkXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0ICQuZ2V0SlNPTihcbiAgICAgICAgYGJha2VkX3F1ZXVlcy8ke2dsb2JhbFRoaXMudWlkfS5qc29uP3Q9JHtEYXRlLm5vdygpfWAsXG4gICAgKVxuICAgIHJldHVybiByZXN1bHRcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dfZGF0YShkYXRhKTogUHJvbWlzZTxhbnk+IHtcbiAgICAvL2lmIChNT0NLTU9ERSkge1xuICAgIC8vICAgIGNvbnNvbGUubG9nKFwibG9nZ2VkIChtb2NrKVwiLCBkYXRhKVxuICAgIC8vICAgIHJldHVyblxuICAgIC8vfVxuICAgIFxuICAgIGRhdGFbXCJ1cmxfZGF0YVwiXSA9IGdsb2JhbFRoaXMudXJsX2RhdGFcbiAgICBjb25zb2xlLmxvZyhcIkRhdGFcIilcbiAgICBpZiAoIShcInN0dWR5X2lkXCIgaW4gZGF0YVsndXJsX2RhdGEnXSkpIHtcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInN0dWR5X2lkXCJdID0gXCJkZW1vX3N0dWR5XCJcbiAgICB9XG4gICAgaWYgKCEoXCJwcm9saWZpY19pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XG4gICAgICAgIGRhdGFbJ3VybF9kYXRhJ11bXCJwcm9saWZpY19pZFwiXSA9IFwiZGVtb191c2VyXCJcbiAgICB9XG4gICAgaWYgKCEoXCJzZXNzaW9uX2lkXCIgaW4gZGF0YVsndXJsX2RhdGEnXSkpIHtcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInNlc3Npb25faWRcIl0gPSBcImRlbW9fc2Vzc2lvblwiXG4gICAgfVxuICAgIGRhdGFbXCJ1cmxfZGF0YVwiXVtcInF1ZXVlX2lkXCJdID0gZ2xvYmFsVGhpcy51aWRcbiAgICBjb25zb2xlLmxvZyhcImxvZ2dlZFwiLCBkYXRhKVxuICAgIGNvbnNvbGUubG9nKFwiTG9nZ2luZyB0b1wiLCBTRVJWRVJfTE9HX1JPT1QgKyBcImxvZ1wiKVxuXG4gICAgdHJ5IHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0ICQuYWpheChcbiAgICAgICAgICAgIFNFUlZFUl9MT0dfUk9PVCArIFwibG9nXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiBcInZsbS1yYXRpb25hbGVzLXN0dWR5L1wiK2RhdGFbJ3VybF9kYXRhJ11bJ3N0dWR5X2lkJ10sXG4gICAgICAgICAgICAgICAgICAgIHVpZDogZ2xvYmFsVGhpcy51aWQucmVwbGFjZShcIi9cIiwgXCJfXCIpICsgXCJfXCIgKyBkYXRhWyd1cmxfZGF0YSddWydwcm9saWZpY19pZCddLFxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgICBhd2FpdCBzbGVlcCgyMDAwKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICB9XG59IiwiLy9tYWluLnRzXG5pbXBvcnQgeyBERVZNT0RFLCBSRVdBUkRfQ09SUkVDVCwgUEVOQUxUWV9JTkNPUlJFQ1QsIEVOQUJMRV9USU1FUiB9IGZyb20gXCIuL2dsb2JhbHNcIlxuZXhwb3J0IHZhciBVSUQ6IHN0cmluZ1xuZXhwb3J0IHZhciBNT0NLTU9ERTogYm9vbGVhbiA9IGZhbHNlXG5pbXBvcnQgeyBsb2FkX2RhdGEsIGxvZ19kYXRhIH0gZnJvbSAnLi9jb25uZWN0b3InXG5pbXBvcnQgeyBwYXJhbXNUb09iamVjdCB9IGZyb20gXCIuL3V0aWxzXCJcblxudmFyIGRhdGE6IGFueVtdID0gW11cbmxldCBxdWVzdGlvbl9pID0gLTFcbmxldCBxdWVzdGlvbjogYW55ID0gbnVsbFxubGV0IHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seTogbnVtYmVyID0gLTFcbmxldCB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbjogbnVtYmVyID0gLTFcbmxldCB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHk6IG51bWJlciA9IC0xXG5sZXQgbnVtX2NvcnJlY3QgPSAwXG5sZXQgbnVtX2luY29ycmVjdCA9IDBcbmxldCBudW1fdW5zdXJlID0gMFxuXG5sZXQgYmFsYW5jZSA9IDBcblxubGV0IGluc3RydWN0aW9uX2k6IG51bWJlciA9IDBcbmxldCBjb3VudF9leGl0ZWRfcGFnZTogbnVtYmVyID0gMFxuXG5mdW5jdGlvbiBhc3NlcnQoY29uZGl0aW9uLCBtZXNzYWdlKSB7XG4gICAgaWYgKCFjb25kaXRpb24pIHtcbiAgICAgICAgdGhyb3cgbWVzc2FnZSB8fCBcIkFzc2VydGlvbiBmYWlsZWRcIjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlZ2lzdGVyQW5zd2VyT25seVVzZXJTZWxlY3Rpb24odXNlcl9jaG9pY2U6IG51bWJlcikge1xuICAgIHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSA9IHVzZXJfY2hvaWNlXG5cbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydW5zdXJlXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICBpZiAodXNlcl9jaG9pY2UgPT0gMCkge1xuICAgICAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMSkge1xuICAgICAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMikge1xuICAgICAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ1bnN1cmVcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH1cbiAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX2RpdlwiKS5zaG93KClcbn1cbi8vIEV2ZW50IGxpc3RlbmVyIGZvciB0aGUgYnV0dG9uIGNsaWNrXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0cycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyQW5zd2VyT25seVVzZXJTZWxlY3Rpb24oMCkpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHMnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlckFuc3dlck9ubHlVc2VyU2VsZWN0aW9uKDEpKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fYW5zd2Vyb25seV91c2VydW5zdXJlJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbigyKSk7XG5cblxuZnVuY3Rpb24gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25Vc2VyU2VsZWN0aW9uKHVzZXJfY2hvaWNlOiBudW1iZXIpIHtcbiAgICB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbiA9IHVzZXJfY2hvaWNlXG5cbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICBpZiAodXNlcl9jaG9pY2UgPT0gMCkge1xuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAxKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICB9IGVsc2UgaWYgKHVzZXJfY2hvaWNlID09IDIpIHtcbiAgICAgICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ1bnN1cmVcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH1cbiAgICBzaG93UXVhbGl0eURpdigpXG59XG5cbmZ1bmN0aW9uIHNob3dRdWFsaXR5RGl2KCkge1xuICAgIGlmIChxdWFsaXR5VHlwZSA9PSBcInZmX29ubHlcIiB8fCBxdWFsaXR5VHlwZSA9PSBcInZmX2NvbnRyX2JvdGhcIikge1xuICAgICAgICBpZiAocXVhbGl0eUZvcm1hdCA9PSBcIm51bWVyaWNcIikgeyAkKFwiI3ZmX251bWVyaWNfZGl2XCIpLnNob3coKSB9XG4gICAgICAgIGlmIChxdWFsaXR5Rm9ybWF0ID09IFwiZGVzY3JpcHRpdmVcIikgeyAkKFwiI3ZmX2Rlc2NyaXB0aXZlX2RpdlwiKS5zaG93KCkgfVxuICAgIH1cbiAgICBpZiAocXVhbGl0eVR5cGUgPT0gXCJjb250cl9vbmx5XCIgfHwgcXVhbGl0eVR5cGUgPT0gXCJ2Zl9jb250cl9ib3RoXCIpIHtcbiAgICAgICAgaWYgKHF1YWxpdHlGb3JtYXQgPT0gXCJudW1lcmljXCIpIHsgJChcIiNjb250cl9udW1lcmljX2RpdlwiKS5zaG93KCkgfVxuICAgICAgICBpZiAocXVhbGl0eUZvcm1hdCA9PSBcImRlc2NyaXB0aXZlXCIpIHsgJChcIiNjb250cl9kZXNjcmlwdGl2ZV9kaXZcIikuc2hvdygpIH1cbiAgICB9XG4gICAgaWYgKHF1YWxpdHlUeXBlID09IFwic2luZ2xlX251bWVyaWNcIikge1xuICAgICAgICBhc3NlcnQgKHF1YWxpdHlGb3JtYXQgPT0gXCJudW1lcmljXCIsIFwicXVhbGl0eUZvcm1hdCBtdXN0IGJlIG51bWVyaWMgZm9yIHNpbmdsZV9udW1lcmljXCIpXG4gICAgICAgICQoXCIjc2luZ2xlX251bWVyaWNfZGl2XCIpLnNob3coKVxuICAgIH1cbn1cblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0cycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uVXNlclNlbGVjdGlvbigwKSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25Vc2VyU2VsZWN0aW9uKDEpKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ1bnN1cmUnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblVzZXJTZWxlY3Rpb24oMikpO1xuICBcbmZ1bmN0aW9uIHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24odXNlcl9jaG9pY2U6IG51bWJlcikge1xuICAgIHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSA9IHVzZXJfY2hvaWNlXG5cbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydW5zdXJlXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICBpZiAodXNlcl9jaG9pY2UgPT0gMCkge1xuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMSkge1xuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMikge1xuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ1bnN1cmVcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH1cbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLnNob3coKVxuICAgICQoXCIjYnV0dG9uX25leHRcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG59XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbigwKSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0cycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24oMSkpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ1bnN1cmUnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblF1YWxpdHlVc2VyU2VsZWN0aW9uKDIpKTtcblxuXG5mdW5jdGlvbiB1cGRhdGVSZXdhcmRJbnN0cnVjdGlvbnMoKSB7XG4gICAgY29uc3QgcmV3YXJkSW5zdHJ1Y3Rpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jld2FyZF9pbnN0cnVjdGlvbnMnKTtcblxuICAgIGlmIChyZXdhcmRJbnN0cnVjdGlvbnMpIHtcbiAgICAgICAgcmV3YXJkSW5zdHJ1Y3Rpb25zLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIElmIHlvdXIgZmluYWwgZGVjaXNpb24gaXMgY29ycmVjdCwgeW91IGdhaW4gYSByZXdhcmQgb2YgJCR7UkVXQVJEX0NPUlJFQ1QudG9GaXhlZCgyKX0uIFxuICAgICAgICAgICAgSWYgeW91ciBmaW5hbCBkZWNpc2lvbiBpcyBpbmNvcnJlY3QsIHlvdSBsb3NlICQke01hdGguYWJzKFBFTkFMVFlfSU5DT1JSRUNUKS50b0ZpeGVkKDIpfSBmcm9tIHlvdXIgcmV3YXJkLiBcbiAgICAgICAgICAgIFlvdSB3aWxsIHNlZSB5b3VyIHRvdGFsIHJld2FyZCBhdCB0aGUgZW5kIG9mIHRoZSBleHBlcmltZW50LiBcbiAgICAgICAgICAgIFlvdXIgcGF5bWVudCBpcyAkMi4wIHBsdXMgd2hhdGV2ZXIgeW91IGFjY3VtdWxhdGUgZHVyaW5nIHRoaXMgZXhwZXJpbWVudC5cbiAgICAgICAgYDtcbiAgICAgICAgLy8gSWYgeW91ciBmaW5hbCBkZWNpc2lvbiBpcyBjb3JyZWN0LCB5b3UgZ2FpbiBhIHJld2FyZCBvZiAkMC4xMC4gSWYgeW91ciBmaW5hbCBkZWNpc2lvbiBpcyBpbmNvcnJlY3QsIHlvdSBsb3NlICQwLjEwIGZyb20geW91ciByZXdhcmQuXG4gICAgICAgIC8vIFlvdSB3aWxsIHNlZSB5b3VyIHRvdGFsIHJld2FyZCBhdCB0aGUgZW5kIG9mIHRoZSBleHBlcmltZW50LiBZb3VyIHBheW1lbnQgaXMgJDIuMCBwbHVzIHdoYXRldmVyIHlvdSBhY2N1bXVsYXRlIGR1cmluZyB0aGlzIGV4cGVyaW1lbnQuXG4gICAgfVxufVxuXG4vKipcbiAqIFBpY2sgdGhlIGNvcnJlY3QgaW5zdHJ1Y3Rpb24gaW1hZ2UuXG4gKiAgIGltZy9pbnN0cnVjdGlvbnNfPGk+LnBuZyAgICAgICAgICAgICAgKGRlZmF1bHQpXG4gKiAgIGltZy9pbnN0cnVjdGlvbnNfPGk+X25vX2Nob2ljZXMucG5nICAgKHZpendpeiBldGMuKVxuICovXG5mdW5jdGlvbiBnZXRJbnN0ckltZyhmaWxlU3RlbTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZ2xvYmFsVGhpcy5ub0Nob2ljZXNEYXRhc2V0XG4gICAgICAgID8gYGltZy8ke2ZpbGVTdGVtfV9ub19jaG9pY2VzLnBuZ2BcbiAgICAgICAgOiBgaW1nLyR7ZmlsZVN0ZW19LnBuZ2A7XG59XG5cblxuZnVuY3Rpb24gbmV4dF9pbnN0cnVjdGlvbnMoaW5jcmVtZW50OiBudW1iZXIpIHtcbiAgICBpbnN0cnVjdGlvbl9pICs9IGluY3JlbWVudFxuXG4gICAgaWYgKGluc3RydWN0aW9uX2kgPT0gMCkge1xuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgfVxuICAgIGlmIChpbnN0cnVjdGlvbl9pID49IDUpIHtcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLnNob3coKVxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS52YWwoXCJTdGFydCBzdHVkeVwiKVxuICAgIH0gZWxzZSB7XG4gICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5oaWRlKClcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikudmFsKFwiTmV4dFwiKVxuICAgIH1cbiAgICBpZiAoaW5zdHJ1Y3Rpb25faSA9PSA2KSB7XG4gICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5zaG93KClcbiAgICAgICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuaGlkZSgpXG4gICAgICAgICQoXCIjbWFpbl9ib3hfZXhwZXJpbWVudFwiKS5zaG93KClcbiAgICAgICAgbmV4dF9xdWVzdGlvbigpXG4gICAgfVxuXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuY2hpbGRyZW4oXCI6bm90KGlucHV0KVwiKS5lYWNoKChfLCBlbCkgPT4ge1xuICAgICAgICAkKGVsKS5oaWRlKClcbiAgICB9KVxuICAgICQoYCNpbnN0cnVjdGlvbnNfJHtpbnN0cnVjdGlvbl9pfWApLnNob3coKVxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDQpIHtcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfNFwiKS5jaGlsZHJlbihcImRpdlwiKS5lYWNoKChfLCBlbCkgPT4geyAkKGVsKS5oaWRlKCkgIH0pXG4gICAgICAgIGlmIChxdWFsaXR5VHlwZSA9PSBcInZmX2NvbnRyX2JvdGhcIiAmJiBxdWFsaXR5Rm9ybWF0ID09IFwibnVtZXJpY1wiKSB7ICQoXCIjaW5zdHJ1Y3Rpb25fdmZfY29udHJfYm90aF9udW1lcmljXCIpLnNob3coKSB9XG4gICAgICAgIGlmIChxdWFsaXR5VHlwZSA9PSBcInZmX29ubHlcIiAmJiBxdWFsaXR5Rm9ybWF0ID09IFwibnVtZXJpY1wiKSB7ICQoXCIjaW5zdHJ1Y3Rpb25fdmZfbnVtZXJpY1wiKS5zaG93KCkgfVxuICAgICAgICBpZiAocXVhbGl0eVR5cGUgPT0gXCJjb250cl9vbmx5XCIgJiYgcXVhbGl0eUZvcm1hdCA9PSBcIm51bWVyaWNcIikgeyAkKFwiI2luc3RydWN0aW9uX2NvbnRyX251bWVyaWNcIikuc2hvdygpIH1cbiAgICAgICAgaWYgKHF1YWxpdHlUeXBlID09IFwic2luZ2xlX251bWVyaWNcIiAmJiBxdWFsaXR5Rm9ybWF0ID09IFwibnVtZXJpY1wiKSB7ICQoXCIjaW5zdHJ1Y3Rpb25fc2luZ2xlX251bWVyaWNcIikuc2hvdygpIH1cbiAgICAgICAgaWYgKHF1YWxpdHlUeXBlID09IFwidmZfY29udHJfYm90aFwiICYmIHF1YWxpdHlGb3JtYXQgPT0gXCJkZXNjcmlwdGl2ZVwiKSB7ICQoXCIjaW5zdHJ1Y3Rpb25fdmZfY29udHJfYm90aF9kZXNjcmlwdGl2ZVwiKS5zaG93KCkgfVxuICAgICAgICBpZiAocXVhbGl0eVR5cGUgPT0gXCJ2Zl9vbmx5XCIgJiYgcXVhbGl0eUZvcm1hdCA9PSBcImRlc2NyaXB0aXZlXCIpIHsgJChcIiNpbnN0cnVjdGlvbl92Zl9kZXNjcmlwdGl2ZVwiKS5zaG93KCkgfVxuICAgICAgICBpZiAocXVhbGl0eVR5cGUgPT0gXCJjb250cl9vbmx5XCIgJiYgcXVhbGl0eUZvcm1hdCA9PSBcImRlc2NyaXB0aXZlXCIpIHsgJChcIiNpbnN0cnVjdGlvbl9jb250cl9kZXNjcmlwdGl2ZVwiKS5zaG93KCkgfVxuICAgIH1cbn1cbiQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4gbmV4dF9pbnN0cnVjdGlvbnMoKzEpKVxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygtMSkpXG5cbmZ1bmN0aW9uIHV0aWxpdHlfb2Zfc2VsZWN0aW9uKHNlbGVjdGlvbjogbnVtYmVyKSB7XG4gICAgbGV0IHV0aWxpdHk6IG51bWJlciA9IDBcbiAgICBpZiAoc2VsZWN0aW9uID09IDIpIHtcbiAgICAgICAgdXRpbGl0eSA9IDBcbiAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgY29ycmVjdF9zZWxlY3Rpb24gPSAxIC0gcXVlc3Rpb25bXCJwcmVkaWN0aW9uX2lzX2NvcnJlY3RcIl0gLy8gMCBpZiBBSSBpcyBjb3JyZWN0LCAxIGlmIGluY29ycmVjdFxuICAgICAgICB1dGlsaXR5ID0gKHNlbGVjdGlvbiA9PSBjb3JyZWN0X3NlbGVjdGlvbikgPyAxIDogLTFcbiAgICB9XG4gICAgcmV0dXJuIHV0aWxpdHlcbn1cblxuJChcIiNidXR0b25fbmV4dFwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcblxuICAgIC8vIFVwZGF0ZSB0aGUgdXNlciBiYWxhbmNlXG4gICAgbGV0IG9sZF9iYWxhbmNlID0gYmFsYW5jZVxuICAgIHVwZGF0ZV9iYWxhbmNlKClcblxuICAgIGlmIChxdWVzdGlvbl9pICE9IC0xKSB7XG4gICAgICAgIGxldCBsb2dnZWRfZGF0YSA9IHtcbiAgICAgICAgICAgIFwicXVlc3Rpb25faVwiOiBxdWVzdGlvbl9pLFxuICAgICAgICAgICAgXCJ1c2VyX3NlbGVjdGlvbnNcIjoge1xuICAgICAgICAgICAgICAgIFwiYW5zd2Vyb25seVwiOiB1c2Vyc2VsZWN0aW9uX2Fuc3dlcm9ubHksXG4gICAgICAgICAgICAgICAgXCJ3aXRoZXhwbGFuYXRpb25cIjogdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb24sXG4gICAgICAgICAgICAgICAgXCJ3aXRoZXhwbGFuYXRpb25xdWFsaXR5XCI6IHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwidXNlcl9pc19jb3JyZWN0XCI6IHtcbiAgICAgICAgICAgICAgICBcImFuc3dlcm9ubHlcIjogaXNfdXNlcl9jb3JyZWN0KHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSksXG4gICAgICAgICAgICAgICAgXCJ3aXRoZXhwbGFuYXRpb25cIjogaXNfdXNlcl9jb3JyZWN0KHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uKSxcbiAgICAgICAgICAgICAgICBcIndpdGhleHBsYW5hdGlvbnF1YWxpdHlcIjogaXNfdXNlcl9jb3JyZWN0KHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcInV0aWxpdHlfb2ZfZXhwbGFuYXRpb25cIjogdXRpbGl0eV9vZl9zZWxlY3Rpb24odXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb24pIC0gdXRpbGl0eV9vZl9zZWxlY3Rpb24odXNlcnNlbGVjdGlvbl9hbnN3ZXJvbmx5KSxcbiAgICAgICAgICAgIFwidXRpbGl0eV9vZl9xdWFsaXR5X21ldHJpY3NcIjogdXRpbGl0eV9vZl9zZWxlY3Rpb24odXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5KSAtIHV0aWxpdHlfb2Zfc2VsZWN0aW9uKHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uKSxcbiAgICAgICAgICAgIFwiYmFsYW5jZVwiOiB7XG4gICAgICAgICAgICAgICAgXCJvbGRcIjogb2xkX2JhbGFuY2UsXG4gICAgICAgICAgICAgICAgXCJuZXdcIjogYmFsYW5jZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VkX2RhdGFbJ3F1ZXN0aW9uJ10gPSBxdWVzdGlvblxuICAgICAgICBsb2dnZWRfZGF0YVsnY291bnRfZXhpdGVkX3BhZ2UnXSA9IGNvdW50X2V4aXRlZF9wYWdlXG4gICAgICAgIGxvZ19kYXRhKGxvZ2dlZF9kYXRhKVxuICAgICAgICBjb3VudF9leGl0ZWRfcGFnZSA9IDBcbiAgICB9XG4gICAgXG5cbiAgICBuZXh0X3F1ZXN0aW9uKClcbn0pO1xuXG5cbmZ1bmN0aW9uIGlzX3VzZXJfY29ycmVjdChzZWxlY3Rpb24pIHtcbiAgICBpZiAoc2VsZWN0aW9uICE9IDIpIHtcbiAgICAgICAgbGV0IGNvcnJlY3Rfc2VsZWN0aW9uID0gMSAtIHF1ZXN0aW9uW1wicHJlZGljdGlvbl9pc19jb3JyZWN0XCJdIC8vIDAgaWYgQUkgaXMgY29ycmVjdCwgMSBpZiBpbmNvcnJlY3RcbiAgICAgICAgcmV0dXJuIHNlbGVjdGlvbiA9PSBjb3JyZWN0X3NlbGVjdGlvbiA/IDEgOiAwXG4gICAgfVxuICAgIHJldHVybiAtMVxufVxuXG5mdW5jdGlvbiB1cGRhdGVfYmFsYW5jZSgpIHtcbiAgICBpZiAodXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5ICE9IDIpIHtcbiAgICAgICAgbGV0IGNvcnJlY3Rfc2VsZWN0aW9uID0gMSAtIHF1ZXN0aW9uW1wicHJlZGljdGlvbl9pc19jb3JyZWN0XCJdIC8vIDAgaWYgQUkgaXMgY29ycmVjdCwgMSBpZiBpbmNvcnJlY3RcbiAgICAgICAgaWYgKHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSA9PSBjb3JyZWN0X3NlbGVjdGlvbikge1xuICAgICAgICAgICAgYmFsYW5jZSArPSBSRVdBUkRfQ09SUkVDVDtcbiAgICAgICAgICAgIG51bV9jb3JyZWN0ICs9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBiYWxhbmNlICs9IFBFTkFMVFlfSU5DT1JSRUNUO1xuICAgICAgICAgICAgbnVtX2luY29ycmVjdCArPSAxO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbnVtX3Vuc3VyZSArPSAxO1xuICAgIH1cbn1cblxuLy8gVG8gZW5zdXJlIGJhbGFuY2UgaXMgbm9uLW5lZ2F0aXZlXG5mdW5jdGlvbiBmaW5hbGl6ZV9iYWxhbmNlKCkge1xuICAgIGJhbGFuY2UgPSBNYXRoLm1heCgwLCBiYWxhbmNlKTtcbiAgICByZXR1cm4gYmFsYW5jZTtcbn1cblxubGV0IGFjdGl2ZVRpbWVyOiBSZXR1cm5UeXBlPHR5cGVvZiBzZXRJbnRlcnZhbD4gfCBudWxsID0gbnVsbDsgLy8gVGltZXIgaW50ZXJ2YWxcblxuZnVuY3Rpb24gc3RhcnRUaW1lcihkdXJhdGlvbiwgc3RlcERpdiwgYnV0dG9ucywgY2FsbGJhY2spIHtcbiAgICBpZiAoIUVOQUJMRV9USU1FUikge1xuICAgICAgICAvLyBJZiB0aGUgdGltZXIgaXMgZGlzYWJsZWQsIGVuYWJsZSB0aGUgYnV0dG9ucyBpbW1lZGlhdGVseVxuICAgICAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSk7XG4gICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENsZWFyIGFueSBleGlzdGluZyB0aW1lciB0byBwcmV2ZW50IG11bHRpcGxlIGludGVydmFsc1xuICAgIGlmIChhY3RpdmVUaW1lcikge1xuICAgICAgICBjbGVhckludGVydmFsKGFjdGl2ZVRpbWVyKTtcbiAgICAgICAgYWN0aXZlVGltZXIgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIERpc2FibGUgYnV0dG9uc1xuICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwidHJ1ZVwiKSk7XG4gICAgXG4gICAgLy8gU2hvdyB0aW1lciB2aXN1YWxseVxuICAgIGxldCB0aW1lckRpc3BsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aW1lckRpc3BsYXkuaWQgPSBgdGltZXJfJHtzdGVwRGl2LmlkfWA7XG4gICAgdGltZXJEaXNwbGF5LnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XG4gICAgdGltZXJEaXNwbGF5LnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JztcbiAgICBzdGVwRGl2LmFwcGVuZENoaWxkKHRpbWVyRGlzcGxheSk7XG5cbiAgICBsZXQgcmVtYWluaW5nVGltZSA9IGR1cmF0aW9uO1xuXG4gICAgLy8gSW5pdGlhbCBkaXNwbGF5XG4gICAgdGltZXJEaXNwbGF5LnRleHRDb250ZW50ID0gYFBsZWFzZSB3YWl0ICR7cmVtYWluaW5nVGltZX0gc2Vjb25kKHMpIGJlZm9yZSBtYWtpbmcgeW91ciBzZWxlY3Rpb24uYDtcblxuICAgIGFjdGl2ZVRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICByZW1haW5pbmdUaW1lLS07XG4gICAgICAgIGlmIChyZW1haW5pbmdUaW1lID49IDApIHtcbiAgICAgICAgICAgIHRpbWVyRGlzcGxheS50ZXh0Q29udGVudCA9IGBQbGVhc2Ugd2FpdCAke3JlbWFpbmluZ1RpbWV9IHNlY29uZChzKSBiZWZvcmUgbWFraW5nIHlvdXIgc2VsZWN0aW9uLmA7XG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIGlmIChhY3RpdmVUaW1lciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYWN0aXZlVGltZXIpOyAvLyBTdG9wIHRoZSB0aW1lclxuICAgICAgICAgICAgICAgIGFjdGl2ZVRpbWVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFjdGl2ZVRpbWVyID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gUmVtb3ZlIHRpbWVyIGRpc3BsYXlcbiAgICAgICAgICAgIHN0ZXBEaXYucmVtb3ZlQ2hpbGQodGltZXJEaXNwbGF5KTtcblxuICAgICAgICAgICAgLy8gRW5hYmxlIGJ1dHRvbnNcbiAgICAgICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpKTtcblxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfSwgMTAwMCk7XG59XG5cbi8vIFdoZW4gdGhlIHVzZXIgc3dpdGNoZXMgdGFicyBvciBtaW5pbWl6ZXMgdGhlIHdpbmRvdywgcGF1c2UgdGhlIHRpbWVyXG5kb2N1bWVudC5vbnZpc2liaWxpdHljaGFuZ2UgPSAoKSA9PiB7XG4gICAgaWYgKGRvY3VtZW50LmhpZGRlbikge1xuICAgICAgICBjb25zb2xlLmxvZyhcIldpbmRvdyBsb3N0IGZvY3VzLlwiKTtcbiAgICAgICAgaWYgKGFjdGl2ZVRpbWVyICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKGFjdGl2ZVRpbWVyKTsgLy8gUGF1c2UgdGhlIHRpbWVyXG4gICAgICAgICAgICBhY3RpdmVUaW1lciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBIYW5kbGUgbG9naWMgd2hlbiB0aGUgdXNlciByZXR1cm5zXG4gICAgICAgIGNvbnNvbGUubG9nKFwiV2luZG93IHJlZ2FpbmVkIGZvY3VzLlwiKTtcbiAgICB9XG59O1xuXG4vLyBGaXJzdCBzdGVwOiBlbmZvcmNlIGEgNS1zZWNvbmQgd2FpdFxuZnVuY3Rpb24gc2V0dXBGaXJzdFN0ZXAoZXhwbGFuYXRpb25UZXh0KSB7XG4gICAgY29uc3QgZmlyc3RTdGVwRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FpX2Fuc3dlcl9kaXYnKTtcbiAgICBjb25zdCBidXR0b25zID0gW1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0cycpLFxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcmRpc3RydXN0cycpLFxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnVuc3VyZScpXG4gICAgXTtcblxuICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uPy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUZpcnN0U3RlcENsaWNrKSk7IC8vIFJlbW92ZSBvbGQgbGlzdGVuZXJzXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlRmlyc3RTdGVwQ2xpY2spKTsgLy8gQWRkIG5ldyBvbmVzXG5cbiAgICBmdW5jdGlvbiBoYW5kbGVGaXJzdFN0ZXBDbGljaygpIHtcbiAgICAgICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24/LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlRmlyc3RTdGVwQ2xpY2spKTsgLy8gQ2xlYW51cFxuICAgICAgICBzZXR1cFNlY29uZFN0ZXAoZXhwbGFuYXRpb25UZXh0KTtcbiAgICB9XG5cbiAgICAkKFwiI2FpX2Fuc3dlcl9kaXZcIikuc2hvdygpO1xuICAgIHN0YXJ0VGltZXIoNSwgZmlyc3RTdGVwRGl2LCBidXR0b25zLCBudWxsKTtcbiAgICAvLyAkKFwiI2FpX2Fuc3dlcl9kaXZcIikuc2hvdygpOyAvLyBTaG93IHRoZSBmaXJzdCBzdGVwXG4gICAgLy8gc3RhcnRUaW1lcig1LCBmaXJzdFN0ZXBEaXYsIGJ1dHRvbnMsICgpID0+IHtcbiAgICAvLyAgICAgLy8gQnV0dG9ucyBhcmUgbm93IGVuYWJsZWQ7IHVzZXIgbXVzdCBjbGljayBvbmUgdG8gcHJvY2VlZFxuICAgIC8vICAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAvLyAgICAgICAgIGJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAvLyAgICAgICAgICAgICAnY2xpY2snLFxuICAgIC8vICAgICAgICAgICAgICgpID0+IHtcbiAgICAvLyAgICAgICAgICAgICAgICAgc2V0dXBTZWNvbmRTdGVwKGV4cGxhbmF0aW9uVGV4dCk7IC8vIFByb2NlZWQgdG8gdGhlIHNlY29uZCBzdGVwIGFmdGVyIGJ1dHRvbiBjbGlja1xuICAgIC8vICAgICAgICAgICAgIH0sXG4gICAgLy8gICAgICAgICAgICAgeyBvbmNlOiB0cnVlIH0gLy8gRW5zdXJlIHRoZSBldmVudCBsaXN0ZW5lciBpcyBleGVjdXRlZCBvbmx5IG9uY2VcbiAgICAvLyAgICAgICAgICk7XG4gICAgLy8gICAgIH0pO1xuICAgIC8vIH0pO1xufVxuXG4vLyBTZWNvbmQgc3RlcCB0aW1lciAoZHluYW1pYyBiYXNlZCBvbiByZWFkaW5nIHRpbWUpXG5mdW5jdGlvbiBzZXR1cFNlY29uZFN0ZXAoZXhwbGFuYXRpb25UZXh0KSB7XG4gICAgY29uc3Qgc2Vjb25kU3RlcERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhaV9leHBsYW5hdGlvbl9kaXYnKTtcbiAgICBjb25zdCB3b3JkcyA9IGV4cGxhbmF0aW9uVGV4dC5zcGxpdCgnICcpLmxlbmd0aDtcbiAgICBjb25zdCByZWFkaW5nVGltZSA9IE1hdGgubWF4KE1hdGguY2VpbCgzICsgKHdvcmRzIC8gMjM4KSAqIDYwKSwgNSk7XG5cbiAgICBjb25zdCBidXR0b25zID0gW1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydHJ1c3RzJyksXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHMnKSxcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnVuc3VyZScpXG4gICAgXTtcblxuICAgIC8vIFJlbW92ZSBvbGQgZXZlbnQgbGlzdGVuZXJzXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24/LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlU2Vjb25kU3RlcENsaWNrKSk7XG5cbiAgICAvLyBBZGQgbmV3IGV2ZW50IGxpc3RlbmVyc1xuICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVNlY29uZFN0ZXBDbGljaykpO1xuXG4gICAgZnVuY3Rpb24gaGFuZGxlU2Vjb25kU3RlcENsaWNrKCkge1xuICAgICAgICAvLyBDbGVhbnVwOiByZW1vdmUgZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uPy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVNlY29uZFN0ZXBDbGljaykpO1xuICAgICAgICBzZXR1cFRoaXJkU3RlcChleHBsYW5hdGlvblRleHQpO1xuICAgIH1cblxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fZGl2XCIpLnNob3coKTsgLy8gU2hvdyB0aGUgc2Vjb25kIHN0ZXBcbiAgICBzdGFydFRpbWVyKHJlYWRpbmdUaW1lLCBzZWNvbmRTdGVwRGl2LCBidXR0b25zLCBudWxsKTsgLy8gU3RhcnQgdGltZXJcbn1cblxuLy8gVGhpcmQgc3RlcCB0aW1lciAoNSBzZWNvbmRzKVxuZnVuY3Rpb24gc2V0dXBUaGlyZFN0ZXAoZXhwbGFuYXRpb25UZXh0KSB7XG4gICAgY29uc3QgdGhpcmRTdGVwRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FpX2V4cGxhbmF0aW9uX3F1YWxpdHlfZGl2Jyk7XG4gICAgY29uc3QgYnV0dG9ucyA9IFtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ0cnVzdHMnKSxcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJkaXN0cnVzdHMnKSxcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ1bnN1cmUnKVxuICAgIF07XG5cbiAgICAvLyBSZW1vdmUgb2xkIGV2ZW50IGxpc3RlbmVyc1xuICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uPy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVRoaXJkU3RlcENsaWNrKSk7XG5cbiAgICAvLyBBZGQgbmV3IGV2ZW50IGxpc3RlbmVyc1xuICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVRoaXJkU3RlcENsaWNrKSk7XG5cbiAgICBmdW5jdGlvbiBoYW5kbGVUaGlyZFN0ZXBDbGljaygpIHtcbiAgICAgICAgLy8gQ2xlYW51cDogcmVtb3ZlIGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbj8ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVUaGlyZFN0ZXBDbGljaykpO1xuICAgICAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLnNob3coKTsgLy8gRW5hYmxlIHRoZSBuZXh0IHF1ZXN0aW9uIGJ1dHRvblxuICAgIH1cblxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fcXVhbGl0eV9kaXZcIikuc2hvdygpOyAvLyBTaG93IHRoZSB0aGlyZCBzdGVwXG4gICAgc3RhcnRUaW1lcig1LCB0aGlyZFN0ZXBEaXYsIGJ1dHRvbnMsIG51bGwpOyAvLyBTdGFydCB0aW1lclxufVxuXG5mdW5jdGlvbiBuZXh0X3F1ZXN0aW9uKCkge1xuICAgIC8vIFJlc2V0IHRpbWVycyBhbmQgc3RhdGVcbiAgICBpZiAoYWN0aXZlVGltZXIpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChhY3RpdmVUaW1lcik7XG4gICAgICAgIGFjdGl2ZVRpbWVyID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLyByZXN0b3JlIHByZXZpb3VzIHN0YXRlIG9mIFVJXG4gICAgJChcIiNidXR0b25fcmVhZHl0b2Fuc3dlclwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl9yZWFkeXRvYW5zd2VyXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjYnV0dG9uX3JlYWR5dG9hbnN3ZXJcIikuc2hvdygpXG5cbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcblxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VyZGlzdHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ1bnN1cmVcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG5cbiAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX2RpdlwiKS5oaWRlKClcbiAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX3F1YWxpdHlfZGl2XCIpLmhpZGUoKVxuICAgIFxuXG4gICAgJChcIiNidXR0b25fbmV4dFwiKS5oaWRlKClcbiAgICAkKCcjYnV0dG9uX3F1aXQnKS5oaWRlKClcbiAgICAvLyQoXCIjcmFuZ2VfdmFsXCIpLnZhbCh1c2VyX3RydXN0KVxuXG4gICAgcXVlc3Rpb25faSArPSAxXG4gICAgaWYgKHF1ZXN0aW9uX2kgPj0gZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLmhpZGUoKVxuICAgICAgICBiYWxhbmNlID0gZmluYWxpemVfYmFsYW5jZSgpXG5cbiAgICAgICAgbGV0IHJld2FyZF90ZXh0ID0gYFlvdXIgdG90YWwgcmV3YXJkIGlzIDxiPiQke2JhbGFuY2UudG9GaXhlZCgyKX0gKyAkMjwvYj4uYFxuICAgICAgICByZXdhcmRfdGV4dCArPSBgPGJyPllvdSBhbnN3ZXJlZCBhIHRvdGFsIG9mICR7cXVlc3Rpb25faX0gcXVlc3Rpb25zOiAke251bV9jb3JyZWN0fSBjb3JyZWN0LCAke251bV9pbmNvcnJlY3R9IGluY29ycmVjdCwgJHtudW1fdW5zdXJlfSB1bnN1cmUuYFxuICAgICAgICAkKCcjcmV3YXJkX2JveCcpLmh0bWwocmV3YXJkX3RleHQpXG4gICAgICAgICQoJyNyZXdhcmRfYm94Jykuc2hvdygpXG4gICAgICAgICQoXCIjbWFpbl9ib3hfZW5kXCIpLnNob3coKVxuICAgICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBxdWVzdGlvbiA9IGRhdGFbcXVlc3Rpb25faV1cblxuICAgIGNvbnN0IHF1ZXN0aW9uVGV4dCA9IHF1ZXN0aW9uIVtcInF1ZXN0aW9uXCJdO1xuICAgIGNvbnN0IHVwZGF0ZWRRdWVzdGlvblRleHQgPSBxdWVzdGlvblRleHQucmVwbGFjZShcIkNob2ljZXM6XCIsIFwiPGJyPjxiPkNob2ljZXM6PC9iPlwiKTtcbiAgICAkKFwiI3F1ZXN0aW9uX3NwYW5cIikuaHRtbCh1cGRhdGVkUXVlc3Rpb25UZXh0KTtcblxuICAgICQoXCIjYWlfcHJlZGljdGlvbl9zcGFuXCIpLmh0bWwocXVlc3Rpb24hW1wicHJlZGljdGVkX2Fuc3dlclwiXSlcbiAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX3NwYW5cIikuaHRtbChxdWVzdGlvbiFbXCJnZW5lcmF0ZWRfcmF0aW9uYWxlXCJdKVxuXG4gICAgbGV0IHZpc3VhbF9maWRlbGl0eV9jb25mID0gTWF0aC5yb3VuZChxdWVzdGlvbiFbXCJ2aXN1YWxfZmlkZWxpdHlcIl0gKiAxMDApXG4gICAgJChcIiNleHBsYW5hdGlvbl9maWRlbGl0eV9udW1lcmljX3NwYW5cIikuaHRtbChgJHt2aXN1YWxfZmlkZWxpdHlfY29uZn0lYClcbiAgICBsZXQgdmlzdWFsX2NvbnRyYXN0aXZlbmVzc19jb25mID0gTWF0aC5yb3VuZChxdWVzdGlvbiFbXCJjb250cmFzdGl2ZW5lc3NcIl0gKiAxMDApXG4gICAgJChcIiNleHBsYW5hdGlvbl9jb250cmFzdGl2ZW5lc3NfbnVtZXJpY19zcGFuXCIpLmh0bWwoYCR7dmlzdWFsX2NvbnRyYXN0aXZlbmVzc19jb25mfSVgKVxuICAgIC8vIFRha2UgcHJvZHVjdCBvZiB0aGUgYWJvdmUgdHdvXG4gICAgbGV0IHNpbmdsZV9udW1lcmljX2NvbmYgPSBNYXRoLnJvdW5kKChxdWVzdGlvbiFbXCJ2aXN1YWxfZmlkZWxpdHlcIl0gKyBxdWVzdGlvbiFbXCJjb250cmFzdGl2ZW5lc3NcIl0pLzIgKiAxMDApXG4gICAgJChcIiNleHBsYW5hdGlvbl9zaW5nbGVfbnVtZXJpY19zcGFuXCIpLmh0bWwoYCR7c2luZ2xlX251bWVyaWNfY29uZn0lYClcbiAgICAvLyBUT0RPOiBGaWxsIGluIHRoZSBkZXRhaWxzIGZvciB0aGUgZGVzY3JpcHRpdmUgcXVhbGl0aWVzXG5cbiAgICBsZXQgdmZfZGVzY3JpcHRpdmUgPSBcIlwiXG4gICAgaWYocXVlc3Rpb25bXCJyZWFzb25fdmZfY29ycmVjdFwiXSA9PSBcIlwiKSB7XG4gICAgICAgIHZmX2Rlc2NyaXB0aXZlICs9IFwiPGI+VGhlcmUgYXJlIG5vIGRldGFpbHMgYWJvdXQgdGhlIGltYWdlIGluIHRoZSBleHBsYW5hdGlvbiB0aGF0IGFyZSBsaWtlbHkgY29ycmVjdC48L2I+XCJcbiAgICB9IGVsc2Uge1xuICAgICAgICB2Zl9kZXNjcmlwdGl2ZSArPSBcIjxiPkRldGFpbHMgaW4gdGhlIGV4cGxhbmF0aW9uIHRoYXQgYXJlIGxpa2VseSBjb3JyZWN0OjwvYj5cIlxuICAgICAgICB2Zl9kZXNjcmlwdGl2ZSArPSBxdWVzdGlvbltcInJlYXNvbl92Zl9jb3JyZWN0XCJdLnJlcGxhY2UoLzxicj4gLS9nLCBcIjxicj4gXFx1MjcwNVwiKVxuICAgIH1cbiAgICBpZiAocXVlc3Rpb25bXCJyZWFzb25fdmZfaW5jb3JyZWN0XCJdID09IFwiXCIpIHtcbiAgICAgICAgdmZfZGVzY3JpcHRpdmUgKz0gXCI8YnI+PGJyPjxiPlRoZXJlIGFyZSBubyBkZXRhaWxzIGFib3V0IHRoZSBpbWFnZSBpbiB0aGUgZXhwbGFuYXRpb24gdGhhdCBhcmUgbGlrZWx5IGluY29ycmVjdC48L2I+XCJcbiAgICB9IGVsc2Uge1xuICAgICAgICB2Zl9kZXNjcmlwdGl2ZSArPSBcIjxicj48YnI+PGI+RGV0YWlscyBpbiB0aGUgZXhwbGFuYXRpb24gdGhhdCBhcmUgbGlrZWx5IE5PVCBjb3JyZWN0OjwvYj5cIlxuICAgICAgICB2Zl9kZXNjcmlwdGl2ZSArPSBxdWVzdGlvbltcInJlYXNvbl92Zl9pbmNvcnJlY3RcIl0ucmVwbGFjZSgvPGJyPiAtL2csIFwiPGJyPiBcXHUyNzRjXCIpXG4gICAgfVxuICAgICQoXCIjZXhwbGFuYXRpb25fZmlkZWxpdHlfZGVzY3JpcHRpdmVfc3BhblwiKS5odG1sKHZmX2Rlc2NyaXB0aXZlKVxuXG4gICAgbGV0IGNvbnRyX2Rlc2NyaXB0aXZlID0gXCJcIlxuICAgIGlmKHF1ZXN0aW9uW1wicmVhc29uX2NvbnRyXCJdID09IFwiXCIpIHtcbiAgICAgICAgY29udHJfZGVzY3JpcHRpdmUgKz0gXCI8Yj5Ob25lIG9mIHRoZSBvdGhlciBjaG9pY2VzIGFyZSBsaWtlbHkgY29ycmVjdCwgYmFzZWQgb24gdGhlIGV4cGxhbmF0aW9uLjwvYj5cIlxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnRyX2Rlc2NyaXB0aXZlICs9IFwiPGI+T3RoZXIgY2hvaWNlcyB0aGF0IGNvdWxkIGJlIGNvcnJlY3QsIGJhc2VkIG9uIHRoZSBleHBsYW5hdGlvbjogPC9iPlwiXG4gICAgICAgIGNvbnRyX2Rlc2NyaXB0aXZlICs9IHF1ZXN0aW9uW1wicmVhc29uX2NvbnRyXCJdXG4gICAgfVxuICAgICQoXCIjZXhwbGFuYXRpb25fY29udHJhc3RpdmVuZXNzX2Rlc2NyaXB0aXZlX3NwYW5cIikuaHRtbChjb250cl9kZXNjcmlwdGl2ZSlcblxuICAgIC8vdGltZV9xdWVzdGlvbl9zdGFydCA9IERhdGUubm93KClcbiAgICAkKFwiI3Byb2dyZXNzXCIpLnRleHQoYFByb2dyZXNzOiAke3F1ZXN0aW9uX2kgKyAxfSAvICR7ZGF0YS5sZW5ndGh9YClcblxuICAgIHNldHVwRmlyc3RTdGVwKHF1ZXN0aW9uW1wiZ2VuZXJhdGVkX3JhdGlvbmFsZVwiXSk7XG59XG5cblxuXG4vLyBnZXQgdXNlciBpZCBhbmQgbG9hZCBxdWV1ZVxuLy8gdHJ5IHRvIHNlZSBpZiBzdGFydCBvdmVycmlkZSB3YXMgcGFzc2VkXG5jb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuY29uc3Qgc3RhcnRPdmVycmlkZSA9IHVybFBhcmFtcy5nZXQoJ3N0YXJ0Jyk7XG5jb25zdCBVSURGcm9tVVJMID0gdXJsUGFyYW1zLmdldChcInVpZFwiKVxuZ2xvYmFsVGhpcy51cmxfZGF0YSA9IHBhcmFtc1RvT2JqZWN0KHVybFBhcmFtcy5lbnRyaWVzKCkpXG5cbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydzdHVkeV9pZCddID09IG51bGwpIHtcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydzdHVkeV9pZCddID0gXCJkZW1vX3N0dWR5XCJcbn1cbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydwcm9saWZpY19pZCddID09IG51bGwpIHtcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydwcm9saWZpY19pZCddID0gXCJkZW1vX3VzZXJcIlxufVxuaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Nlc3Npb25faWQnXSA9PSBudWxsKSB7XG4gICAgZ2xvYmFsVGhpcy51cmxfZGF0YVsnc2Vzc2lvbl9pZCddID0gXCJkZW1vX3Nlc3Npb25cIlxufVxuXG5pZiAoVUlERnJvbVVSTCAhPSBudWxsKSB7XG4gICAgZ2xvYmFsVGhpcy51aWQgPSBVSURGcm9tVVJMIGFzIHN0cmluZ1xuICAgIGlmIChnbG9iYWxUaGlzLnVpZCA9PSBcInByb2xpZmljX3JhbmRvbVwiKSB7XG4gICAgICAgIGxldCBxdWV1ZV9pZCA9IGAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKX1gLnBhZFN0YXJ0KDMsIFwiMFwiKVxuICAgICAgICBnbG9iYWxUaGlzLnVpZCA9IGAke3VybFBhcmFtcy5nZXQoXCJwcm9saWZpY19xdWV1ZV9uYW1lXCIpfS8ke3F1ZXVlX2lkfWBcbiAgICB9XG59IGVsc2UgaWYgKERFVk1PREUpIHtcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFwiZGVtb1wiXG59IGVsc2Uge1xuICAgIGxldCBVSURfbWF5YmU6IGFueSA9IG51bGxcbiAgICB3aGlsZSAoVUlEX21heWJlID09IG51bGwpIHtcbiAgICAgICAgVUlEX21heWJlID0gcHJvbXB0KFwiRW50ZXIgeW91ciB1c2VyIGlkLiBQbGVhc2UgZ2V0IGluIHRvdWNoIGlmIHlvdSB3ZXJlIG5vdCBhc3NpZ25lZCBhbiBpZCBidXQgd2lzaCB0byBwYXJ0aWNpcGF0ZSBpbiB0aGlzIGV4cGVyaW1lbnQuXCIpXG4gICAgfVxuICAgIGdsb2JhbFRoaXMudWlkID0gVUlEX21heWJlIVxufVxuXG5nbG9iYWxUaGlzLm5vQ2hvaWNlc0RhdGFzZXQgPSBnbG9iYWxUaGlzLnVpZC5pbmNsdWRlcyhcInZpendpelwiKTtcblxuXG5jb25zdCB2YWxpZFF1YWxpdHlUeXBlcyA9IFtcInZmX29ubHlcIiwgXCJjb250cl9vbmx5XCIsIFwidmZfY29udHJfYm90aFwiLCBcInNpbmdsZV9udW1lcmljXCJdXG5sZXQgcXVhbGl0eVR5cGUgPSB1cmxQYXJhbXMuZ2V0KFwicXVhbGl0eV90eXBlXCIpXG5pZiAocXVhbGl0eVR5cGUgPT0gbnVsbCkgeyBxdWFsaXR5VHlwZSA9IFwidmZfY29udHJfYm90aFwiIH1cbmlmICghdmFsaWRRdWFsaXR5VHlwZXMuaW5jbHVkZXMocXVhbGl0eVR5cGUpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBxdWFsaXR5IHR5cGVcIilcbn1cblxuY29uc3QgdmFsaWRRdWFsaXR5Rm9ybWF0cyA9IFtcIm51bWVyaWNcIiwgXCJkZXNjcmlwdGl2ZVwiXVxubGV0IHF1YWxpdHlGb3JtYXQgPSB1cmxQYXJhbXMuZ2V0KFwicXVhbGl0eV9mb3JtYXRcIilcbmlmIChxdWFsaXR5Rm9ybWF0ID09IG51bGwpIHsgcXVhbGl0eUZvcm1hdCA9IFwibnVtZXJpY1wiIH1cbmlmICghdmFsaWRRdWFsaXR5Rm9ybWF0cy5pbmNsdWRlcyhxdWFsaXR5Rm9ybWF0KSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcXVhbGl0eSBmb3JtYXRcIilcbn1cblxuZ2xvYmFsVGhpcy51cmxfZGF0YVtcImV4cGxhbmF0aW9uX3F1YWxpdHlfcGFyYW1zXCJdID0ge1xuICAgIFwicXVhbGl0eV90eXBlXCI6IHF1YWxpdHlUeXBlLFxuICAgIFwicXVhbGl0eV9mb3JtYXRcIjogcXVhbGl0eUZvcm1hdFxufVxuY29uc29sZS5sb2coXCJRdWFsaXR5IHBhcmFtc1wiLCBnbG9iYWxUaGlzLnVybF9kYXRhW1wiZXhwbGFuYXRpb25fcXVhbGl0eV9wYXJhbXNcIl0pXG5cbi8vIHZlcnNpb24gZm9yIHBhcGVyXG5pZiAoREVWTU9ERSkge1xuICAgIE1PQ0tNT0RFID0gdHJ1ZVxufSBlbHNlIGlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydzZXNzaW9uX2lkJ10uc3RhcnRzV2l0aChcImRlbW9cIikpIHtcbiAgICBNT0NLTU9ERSA9IHRydWVcbn1cblxuY29uc29sZS5sb2coXCJSdW5uaW5nIHdpdGggVUlEXCIsIGdsb2JhbFRoaXMudWlkKVxubG9hZF9kYXRhKCkuY2F0Y2goKF9lcnJvcikgPT4ge1xuICAgIC8vYWxlcnQoXCJJbnZhbGlkIHVzZXIgaWQuXCIpXG4gICAgY29uc29sZS5sb2coXCJJbnZhbGlkIHVzZXIgaWQuXCIpXG4gICAgY29uc29sZS5sb2coZ2xvYmFsVGhpcy51aWQhKVxuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxufVxuKS50aGVuKChuZXdfZGF0YSkgPT4ge1xuICAgIGRhdGEgPSBuZXdfZGF0YVxuICAgIGlmIChzdGFydE92ZXJyaWRlICE9IG51bGwpIHtcbiAgICAgICAgcXVlc3Rpb25faSA9IHBhcnNlSW50KHN0YXJ0T3ZlcnJpZGUpIC0gMVxuICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0aW5nIGZyb21cIiwgcXVlc3Rpb25faSlcbiAgICB9XG4gICAgLy8gbmV4dF9xdWVzdGlvbigpXG4gICAgbmV4dF9pbnN0cnVjdGlvbnMoMClcbiAgICAkKFwiI2ltZ19pbnN0cl8xXCIpLmF0dHIoXCJzcmNcIiwgZ2V0SW5zdHJJbWcoXCJpbnN0cnVjdGlvbnNfMVwiKSk7XG4gICAgJChcIiNpbWdfaW5zdHJfMlwiKS5hdHRyKFwic3JjXCIsIGdldEluc3RySW1nKFwiaW5zdHJ1Y3Rpb25zXzJcIikpO1xuICAgICQoXCIjaW1nX2luc3RyXzNcIikuYXR0cihcInNyY1wiLCBnZXRJbnN0ckltZyhcImluc3RydWN0aW9uc18zXCIpKTtcbiAgICAkKFwiI2ltZ19pbnN0cl80X3ZmX2NvbnRyX2JvdGhfbnVtZXJpY1wiKVxuICAgICAgICAuYXR0cihcInNyY1wiLCBnZXRJbnN0ckltZyhcImluc3RydWN0aW9uc180X3ZmX2NvbnRyX2JvdGhfbnVtZXJpY1wiKSk7XG4gICAgJChcIiNpbWdfaW5zdHJfNF92Zl9udW1lcmljXCIpXG4gICAgICAgIC5hdHRyKFwic3JjXCIsIGdldEluc3RySW1nKFwiaW5zdHJ1Y3Rpb25zXzRfdmZfbnVtZXJpY1wiKSk7XG4gICAgJChcIiNpbWdfaW5zdHJfNF9jb250cl9udW1lcmljXCIpXG4gICAgICAgIC5hdHRyKFwic3JjXCIsIGdldEluc3RySW1nKFwiaW5zdHJ1Y3Rpb25zXzRfY29udHJfbnVtZXJpY1wiKSk7XG4gICAgJChcIiNpbWdfaW5zdHJfNF9zaW5nbGVfbnVtZXJpY1wiKVxuICAgICAgICAuYXR0cihcInNyY1wiLCBnZXRJbnN0ckltZyhcImluc3RydWN0aW9uc180X3NpbmdsZV9udW1lcmljXCIpKTtcbiAgICAkKFwiI2ltZ19pbnN0cl80X3ZmX2NvbnRyX2JvdGhfZGVzY3JpcHRpdmVcIilcbiAgICAgICAgLmF0dHIoXCJzcmNcIiwgZ2V0SW5zdHJJbWcoXCJpbnN0cnVjdGlvbnNfNF92Zl9jb250cl9ib3RoX2Rlc2NyaXB0aXZlXCIpKTtcbiAgICAkKFwiI2ltZ19pbnN0cl80X3ZmX2Rlc2NyaXB0aXZlXCIpXG4gICAgICAgIC5hdHRyKFwic3JjXCIsIGdldEluc3RySW1nKFwiaW5zdHJ1Y3Rpb25zXzRfdmZfZGVzY3JpcHRpdmVcIikpO1xuICAgICQoXCIjaW1nX2luc3RyXzRfY29udHJfZGVzY3JpcHRpdmVcIilcbiAgICAgICAgLmF0dHIoXCJzcmNcIiwgZ2V0SW5zdHJJbWcoXCJpbnN0cnVjdGlvbnNfNF9jb250cl9kZXNjcmlwdGl2ZVwiKSk7XG5cbiAgICB1cGRhdGVSZXdhcmRJbnN0cnVjdGlvbnMoKTtcbiAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5zaG93KClcbiAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuaGlkZSgpXG59KVxuXG4vLyAvLyBEeW5hbWljYWxseSBsb2FkIGRhdGFzZXQgYmFzZWQgb24gREFUQVNFVFxuLy8gZmV0Y2goYC4vYmFrZWRfcXVldWVzLyR7REFUQVNFVH1gKVxuLy8gICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbi8vICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuLy8gICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGxvYWQgZGF0YXNldC5cIik7XG4vLyAgICAgICAgIH1cbi8vICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbi8vICAgICB9KVxuLy8gICAgIC50aGVuKChuZXdfZGF0YSkgPT4ge1xuLy8gICAgICAgICBkYXRhID0gbmV3X2RhdGE7XG4vLyAgICAgICAgIGlmIChzdGFydE92ZXJyaWRlICE9IG51bGwpIHtcbi8vICAgICAgICAgICAgIHF1ZXN0aW9uX2kgPSBwYXJzZUludChzdGFydE92ZXJyaWRlKSAtIDE7XG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0aW5nIGZyb21cIiwgcXVlc3Rpb25faSk7XG4vLyAgICAgICAgIH1cbi8vICAgICAgICAgbmV4dF9pbnN0cnVjdGlvbnMoMCk7XG4vLyAgICAgICAgIHVwZGF0ZVJld2FyZEluc3RydWN0aW9ucygpO1xuLy8gICAgICAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5zaG93KCk7XG4vLyAgICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5oaWRlKCk7XG4vLyAgICAgfSlcbi8vICAgICAuY2F0Y2goKF9lcnJvcikgPT4ge1xuLy8gICAgICAgICBjb25zb2xlLmVycm9yKFwiSW52YWxpZCB1c2VyIGlkIG9yIGRhdGFzZXQgbG9hZGluZyBmYWlsZWQuXCIpO1xuLy8gICAgICAgICBjb25zb2xlLmxvZyhnbG9iYWxUaGlzLnVpZCEpO1xuLy8gICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4vLyAgICAgfSk7XG5cblxuY29uc29sZS5sb2coXCJTdGFydGluZyBzZXNzaW9uIHdpdGggVUlEOlwiLCBnbG9iYWxUaGlzLnVpZCEpXG5cbmxldCBhbGVydF9hY3RpdmUgPSBmYWxzZVxuZG9jdW1lbnQub252aXNpYmlsaXR5Y2hhbmdlID0gKCkgPT4ge1xuICAgIGlmICghYWxlcnRfYWN0aXZlKSB7XG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlICs9IDFcbiAgICAgICAgYWxlcnRfYWN0aXZlID0gdHJ1ZVxuICAgICAgICBpZiAoIShnbG9iYWxUaGlzLnVpZCEuc3RhcnRzV2l0aChcImRlbW9cIikpKSB7XG4gICAgICAgICAgICAvLyBwYXVzZSB0aGUgdGltZXJcbiAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgZG9uJ3QgbGVhdmUgdGhlIHBhZ2UuIElmIHlvdSBkbyBzbyBhZ2Fpbiwgd2UgbWF5IHJlc3RyaWN0IHBheWluZyB5b3UuXCIpXG4gICAgICAgIH1cbiAgICAgICAgYWxlcnRfYWN0aXZlID0gZmFsc2VcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgICAgLy9jb250aW51ZSB0aGUgdGltZXI/XG4gICAgfVxufSIsIi8vIGdsb2JhbHMudHNcbmRlY2xhcmUgbGV0IF9ERVZNT0RFOiBib29sZWFuXG5cbmV4cG9ydCB2YXIgREVWTU9ERSA9IF9ERVZNT0RFXG5leHBvcnQgY29uc3QgRU5BQkxFX1RJTUVSID0gIV9ERVZNT0RFOyAgLy8gU2V0IHRvIGBmYWxzZWAgdG8gZGlzYWJsZSB0aGUgdGltZXIgZm9yIGRlYnVnZ2luZ1xuXG5leHBvcnQgY29uc3QgUkVXQVJEX0NPUlJFQ1QgPSAwLjE7IC8vIFJld2FyZCBmb3IgYSBjb3JyZWN0IGFuc3dlclxuZXhwb3J0IGNvbnN0IFBFTkFMVFlfSU5DT1JSRUNUID0gLTAuMTsgLy8gUGVuYWx0eSBmb3IgYW4gaW5jb3JyZWN0IGFuc3dlciIsIi8vdXRpbHMudHNcbmZ1bmN0aW9uIHBhcmFtc1RvT2JqZWN0KGVudHJpZXMpIHtcbiAgY29uc3QgcmVzdWx0ID0ge31cbiAgLy8gZWFjaCAnZW50cnknIGlzIGEgW2tleSwgdmFsdWVdIHR1cHBsZVxuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBlbnRyaWVzKSB7XG4gICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgeyBwYXJhbXNUb09iamVjdCB9Il0sIm5hbWVzIjpbIlNFUlZFUl9MT0dfUk9PVCIsImRhdGEiLCJxdWVzdGlvbl9pIiwicXVlc3Rpb24iLCJ1c2Vyc2VsZWN0aW9uX2Fuc3dlcm9ubHkiLCJ1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbiIsInVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSIsIm51bV9jb3JyZWN0IiwibnVtX2luY29ycmVjdCIsIm51bV91bnN1cmUiLCJiYWxhbmNlIiwiaW5zdHJ1Y3Rpb25faSIsImNvdW50X2V4aXRlZF9wYWdlIiwicmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbiIsInVzZXJfY2hvaWNlIiwiJCIsImF0dHIiLCJzaG93IiwicmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25Vc2VyU2VsZWN0aW9uIiwicXVhbGl0eVR5cGUiLCJxdWFsaXR5Rm9ybWF0IiwiY29uZGl0aW9uIiwiYXNzZXJ0IiwicmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbiIsInJlbW92ZUF0dHIiLCJnZXRJbnN0ckltZyIsImZpbGVTdGVtIiwiZ2xvYmFsVGhpcyIsIm5vQ2hvaWNlc0RhdGFzZXQiLCJuZXh0X2luc3RydWN0aW9ucyIsImluY3JlbWVudCIsInZhbCIsImhpZGUiLCJuZXh0X3F1ZXN0aW9uIiwiY2hpbGRyZW4iLCJlYWNoIiwiXyIsImVsIiwidXRpbGl0eV9vZl9zZWxlY3Rpb24iLCJzZWxlY3Rpb24iLCJ1dGlsaXR5IiwiaXNfdXNlcl9jb3JyZWN0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbiIsIm9sZF9iYWxhbmNlIiwiY29ycmVjdF9zZWxlY3Rpb24iLCJ1cGRhdGVfYmFsYW5jZSIsImxvZ2dlZF9kYXRhIiwiYXN5bmMiLCJ1cmxfZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJ1aWQiLCJyZXN1bHQiLCJhamF4IiwiSlNPTiIsInN0cmluZ2lmeSIsInByb2plY3QiLCJyZXBsYWNlIiwicGF5bG9hZCIsInR5cGUiLCJjb250ZW50VHlwZSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInNsZWVwIiwiZSIsImxvZ19kYXRhIiwiYWN0aXZlVGltZXIiLCJzdGFydFRpbWVyIiwiZHVyYXRpb24iLCJzdGVwRGl2IiwiYnV0dG9ucyIsImNhbGxiYWNrIiwiY2xlYXJJbnRlcnZhbCIsImZvckVhY2giLCJidXR0b24iLCJzZXRBdHRyaWJ1dGUiLCJ0aW1lckRpc3BsYXkiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJzdHlsZSIsImZvbnRXZWlnaHQiLCJtYXJnaW5Ub3AiLCJhcHBlbmRDaGlsZCIsInJlbWFpbmluZ1RpbWUiLCJ0ZXh0Q29udGVudCIsInNldEludGVydmFsIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJsZW5ndGgiLCJNYXRoIiwibWF4IiwicmV3YXJkX3RleHQiLCJ0b0ZpeGVkIiwiaHRtbCIsInVwZGF0ZWRRdWVzdGlvblRleHQiLCJ2aXN1YWxfZmlkZWxpdHlfY29uZiIsInJvdW5kIiwidmlzdWFsX2NvbnRyYXN0aXZlbmVzc19jb25mIiwic2luZ2xlX251bWVyaWNfY29uZiIsInZmX2Rlc2NyaXB0aXZlIiwiY29udHJfZGVzY3JpcHRpdmUiLCJ0ZXh0IiwiZXhwbGFuYXRpb25UZXh0IiwiZmlyc3RTdGVwRGl2IiwiaGFuZGxlRmlyc3RTdGVwQ2xpY2siLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2Vjb25kU3RlcERpdiIsIndvcmRzIiwic3BsaXQiLCJyZWFkaW5nVGltZSIsImNlaWwiLCJoYW5kbGVTZWNvbmRTdGVwQ2xpY2siLCJ0aGlyZFN0ZXBEaXYiLCJoYW5kbGVUaGlyZFN0ZXBDbGljayIsInNldHVwVGhpcmRTdGVwIiwic2V0dXBTZWNvbmRTdGVwIiwic2V0dXBGaXJzdFN0ZXAiLCJvbnZpc2liaWxpdHljaGFuZ2UiLCJoaWRkZW4iLCJ1cmxQYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN0YXJ0T3ZlcnJpZGUiLCJnZXQiLCJVSURGcm9tVVJMIiwiZW50cmllcyIsImtleSIsInZhbHVlIiwicGFyYW1zVG9PYmplY3QiLCJxdWV1ZV9pZCIsImZsb29yIiwicmFuZG9tIiwicGFkU3RhcnQiLCJVSURfbWF5YmUiLCJwcm9tcHQiLCJpbmNsdWRlcyIsIkVycm9yIiwic3RhcnRzV2l0aCIsImdldEpTT04iLCJEYXRlIiwibm93IiwibG9hZF9kYXRhIiwiY2F0Y2giLCJfZXJyb3IiLCJyZWxvYWQiLCJ0aGVuIiwibmV3X2RhdGEiLCJwYXJzZUludCIsInJld2FyZEluc3RydWN0aW9ucyIsImlubmVySFRNTCIsImFicyIsInVwZGF0ZVJld2FyZEluc3RydWN0aW9ucyIsImFsZXJ0X2FjdGl2ZSIsImFsZXJ0Il0sInNvdXJjZVJvb3QiOiIifQ==