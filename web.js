(()=>{"use strict";let t="https://tejassrinivasan.pythonanywhere.com/";var e=[];let n=-1,i=null,r=-1,o=-1,s=-1,a=0,u=0,l=0,_=0,c=0,d=0;function h(t){r=t,$("#button_answeronly_usertrusts").attr("disabled","true"),$("#button_answeronly_userdistrusts").attr("disabled","true"),$("#button_answeronly_userunsure").attr("disabled","true"),0==t?$("#button_answeronly_usertrusts").attr("activedecision","true"):1==t?$("#button_answeronly_userdistrusts").attr("activedecision","true"):2==t&&$("#button_answeronly_userunsure").attr("activedecision","true"),$("#ai_explanation_div").show()}function m(t){o=t,$("#button_withexplanation_usertrusts").attr("disabled","true"),$("#button_withexplanation_userdistrusts").attr("disabled","true"),$("#button_withexplanation_userunsure").attr("disabled","true"),0==t?$("#button_withexplanation_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanation_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanation_userunsure").attr("activedecision","true"),"vf_only"!=T&&"vf_contr_both"!=T||("numeric"==k&&$("#vf_numeric_div").show(),"descriptive"==k&&$("#vf_descriptive_div").show()),"contr_only"!=T&&"vf_contr_both"!=T||("numeric"==k&&$("#contr_numeric_div").show(),"descriptive"==k&&$("#contr_descriptive_div").show()),"single_numeric"==T&&(function(t){if(!t)throw"qualityFormat must be numeric for single_numeric"}("numeric"==k),$("#single_numeric_div").show())}function b(t){s=t,$("#button_withexplanationquality_usertrusts").attr("disabled","true"),$("#button_withexplanationquality_userdistrusts").attr("disabled","true"),$("#button_withexplanationquality_userunsure").attr("disabled","true"),0==t?$("#button_withexplanationquality_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanationquality_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanationquality_userunsure").attr("activedecision","true"),$("#button_next").show(),$("#button_next").removeAttr("disabled")}function v(t){return globalThis.noChoicesDataset?`img/${t}_no_choices.png`:`img/${t}.png`}function p(t){c+=t,0==c?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),c>=5?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),6==c&&($("#instructions_and_decorations").show(),$("#main_box_instructions").hide(),$("#main_box_experiment").show(),x()),$("#main_box_instructions").children(":not(input)").each(((t,e)=>{$(e).hide()})),$(`#instructions_${c}`).show(),4==c&&($("#instructions_4").children("div").each(((t,e)=>{$(e).hide()})),"vf_contr_both"==T&&"numeric"==k&&$("#instruction_vf_contr_both_numeric").show(),"vf_only"==T&&"numeric"==k&&$("#instruction_vf_numeric").show(),"contr_only"==T&&"numeric"==k&&$("#instruction_contr_numeric").show(),"single_numeric"==T&&"numeric"==k&&$("#instruction_single_numeric").show(),"vf_contr_both"==T&&"descriptive"==k&&$("#instruction_vf_contr_both_descriptive").show(),"vf_only"==T&&"descriptive"==k&&$("#instruction_vf_descriptive").show(),"contr_only"==T&&"descriptive"==k&&$("#instruction_contr_descriptive").show())}function y(t){let e=0;return e=2==t?0:t==1-i.prediction_is_correct?1:-1,e}function w(t){return 2!=t?t==1-i.prediction_is_correct?1:0:-1}document.getElementById("button_answeronly_usertrusts")?.addEventListener("click",(()=>h(0))),document.getElementById("button_answeronly_userdistrusts")?.addEventListener("click",(()=>h(1))),document.getElementById("button_answeronly_userunsure")?.addEventListener("click",(()=>h(2))),document.getElementById("button_withexplanation_usertrusts")?.addEventListener("click",(()=>m(0))),document.getElementById("button_withexplanation_userdistrusts")?.addEventListener("click",(()=>m(1))),document.getElementById("button_withexplanation_userunsure")?.addEventListener("click",(()=>m(2))),document.getElementById("button_withexplanationquality_usertrusts")?.addEventListener("click",(()=>b(0))),document.getElementById("button_withexplanationquality_userdistrusts")?.addEventListener("click",(()=>b(1))),document.getElementById("button_withexplanationquality_userunsure")?.addEventListener("click",(()=>b(2))),$("#button_instructions_next").on("click",(()=>p(1))),$("#button_instructions_prev").on("click",(()=>p(-1))),$("#button_next").on("click",(()=>{let e=_;if(function(){if(2!=s){let t=1-i.prediction_is_correct;s==t?(_+=.1,a+=1):(_+=-.1,u+=1)}else l+=1}(),-1!=n){let a={question_i:n,user_selections:{answeronly:r,withexplanation:o,withexplanationquality:s},user_is_correct:{answeronly:w(r),withexplanation:w(o),withexplanationquality:w(s)},utility_of_explanation:y(o)-y(r),utility_of_quality_metrics:y(s)-y(o),balance:{old:e,new:_}};a.question=i,a.count_exited_page=d,async function(e){e.url_data=globalThis.url_data,console.log("Data"),"study_id"in e.url_data||(e.url_data.study_id="demo_study"),"prolific_id"in e.url_data||(e.url_data.prolific_id="demo_user"),"session_id"in e.url_data||(e.url_data.session_id="demo_session"),e.url_data.queue_id=globalThis.uid,console.log("logged",e),console.log("Logging to",t+"log");try{let n=await $.ajax(t+"log",{data:JSON.stringify({project:"vlm-rationales-study/"+e.url_data.study_id,uid:globalThis.uid.replace("/","_")+"_"+e.url_data.prolific_id,payload:JSON.stringify(e)}),type:"POST",contentType:"application/json"});return await async function(){return new Promise((t=>setTimeout(t,2e3)))}(),n}catch(t){console.log(t)}}(a),d=0}x()}));let g=null;function f(t,e,n,i){g&&(clearInterval(g),g=null),n.forEach((t=>t.setAttribute("disabled","true")));let r=document.createElement("div");r.id=`timer_${e.id}`,r.style.fontWeight="bold",r.style.marginTop="10px",e.appendChild(r);let o=t;r.textContent=`Please wait ${o} second(s) before making your selection.`,g=setInterval((()=>{o--,o>=0?r.textContent=`Please wait ${o} second(s) before making your selection.`:(null!==g&&(clearInterval(g),g=null),g=null,e.removeChild(r),n.forEach((t=>t.removeAttribute("disabled"))),i&&i())}),1e3)}function x(){if(g&&(clearInterval(g),g=null),$("#button_readytoanswer").removeAttr("activedecision"),$("#button_readytoanswer").removeAttr("disabled"),$("#button_readytoanswer").show(),$("#button_answeronly_usertrusts").removeAttr("activedecision"),$("#button_answeronly_usertrusts").removeAttr("disabled"),$("#button_answeronly_userdistrusts").removeAttr("activedecision"),$("#button_answeronly_userdistrusts").removeAttr("disabled"),$("#button_answeronly_userunsure").removeAttr("activedecision"),$("#button_answeronly_userunsure").removeAttr("disabled"),$("#button_withexplanation_usertrusts").removeAttr("activedecision"),$("#button_withexplanation_usertrusts").removeAttr("disabled"),$("#button_withexplanation_userdistrusts").removeAttr("activedecision"),$("#button_withexplanation_userdistrusts").removeAttr("disabled"),$("#button_withexplanation_userunsure").removeAttr("activedecision"),$("#button_withexplanation_userunsure").removeAttr("disabled"),$("#button_withexplanationquality_usertrusts").removeAttr("activedecision"),$("#button_withexplanationquality_usertrusts").removeAttr("disabled"),$("#button_withexplanationquality_userdistrusts").removeAttr("activedecision"),$("#button_withexplanationquality_userdistrusts").removeAttr("disabled"),$("#button_withexplanationquality_userunsure").removeAttr("activedecision"),$("#button_withexplanationquality_userunsure").removeAttr("disabled"),$("#ai_explanation_div").hide(),$("#ai_explanation_quality_div").hide(),$("#button_next").hide(),$("#button_quit").hide(),n+=1,n>=e.length){$("#main_box_experiment").hide(),_=Math.max(0,_);let t=`Your total reward is <b>$${_.toFixed(2)} + $2</b>.`;return t+=`<br>You answered a total of ${n} questions: ${a} correct, ${u} incorrect, ${l} unsure.`,$("#reward_box").html(t),$("#reward_box").show(),void $("#main_box_end").show()}i=e[n];const t=i.question.replace("Choices:","<br><b>Choices:</b>");$("#question_span").html(t),$("#ai_prediction_span").html(i.predicted_answer),$("#ai_explanation_span").html(i.generated_rationale);let r=Math.round(100*i.visual_fidelity);$("#explanation_fidelity_numeric_span").html(`${r}%`);let o=Math.round(100*i.contrastiveness);$("#explanation_contrastiveness_numeric_span").html(`${o}%`);let s=Math.round((i.visual_fidelity+i.contrastiveness)/2*100);$("#explanation_single_numeric_span").html(`${s}%`);let c="";""==i.reason_vf_correct?c+="<b>There are no details about the image in the explanation that are likely correct.</b>":(c+="<b>Details in the explanation that are likely correct:</b>",c+=i.reason_vf_correct.replace(/<br> -/g,"<br> ✅")),""==i.reason_vf_incorrect?c+="<br><br><b>There are no details about the image in the explanation that are likely incorrect.</b>":(c+="<br><br><b>Details in the explanation that are likely NOT correct:</b>",c+=i.reason_vf_incorrect.replace(/<br> -/g,"<br> ❌")),$("#explanation_fidelity_descriptive_span").html(c);let d="";""==i.reason_contr?d+="<b>None of the other choices are likely correct, based on the explanation.</b>":(d+="<b>Other choices that could be correct, based on the explanation: </b>",d+=i.reason_contr),$("#explanation_contrastiveness_descriptive_span").html(d),$("#progress").text(`Progress: ${n+1} / ${e.length}`),function(t){const e=document.getElementById("ai_answer_div"),n=[document.getElementById("button_answeronly_usertrusts"),document.getElementById("button_answeronly_userdistrusts"),document.getElementById("button_answeronly_userunsure")];function i(){n.forEach((t=>t?.removeEventListener("click",i))),function(t){const e=document.getElementById("ai_explanation_div"),n=t.split(" ").length,i=Math.max(Math.ceil(3+n/238*60),5),r=[document.getElementById("button_withexplanation_usertrusts"),document.getElementById("button_withexplanation_userdistrusts"),document.getElementById("button_withexplanation_userunsure")];function o(){r.forEach((t=>t?.removeEventListener("click",o))),function(){const t=document.getElementById("ai_explanation_quality_div"),e=[document.getElementById("button_withexplanationquality_usertrusts"),document.getElementById("button_withexplanationquality_userdistrusts"),document.getElementById("button_withexplanationquality_userunsure")];function n(){e.forEach((t=>t?.removeEventListener("click",n))),$("#button_next").show()}e.forEach((t=>t?.removeEventListener("click",n))),e.forEach((t=>t?.addEventListener("click",n))),$("#ai_explanation_quality_div").show(),f(5,t,e,null)}()}r.forEach((t=>t?.removeEventListener("click",o))),r.forEach((t=>t?.addEventListener("click",o))),$("#ai_explanation_div").show(),f(i,e,r,null)}(t)}n.forEach((t=>t?.removeEventListener("click",i))),n.forEach((t=>t?.addEventListener("click",i))),$("#ai_answer_div").show(),f(5,e,n,null)}(i.generated_rationale)}document.onvisibilitychange=()=>{document.hidden?(console.log("Window lost focus."),null!==g&&(clearInterval(g),g=null)):console.log("Window regained focus.")};const E=new URLSearchParams(window.location.search),q=E.get("start"),I=E.get("uid");if(globalThis.url_data=function(t){const e={};for(const[n,i]of t)e[n]=i;return e}(E.entries()),null==globalThis.url_data.study_id&&(globalThis.url_data.study_id="demo_study"),null==globalThis.url_data.prolific_id&&(globalThis.url_data.prolific_id="demo_user"),null==globalThis.url_data.session_id&&(globalThis.url_data.session_id="demo_session"),null!=I){if(globalThis.uid=I,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${E.get("prolific_queue_name")}/${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}globalThis.noChoicesDataset=globalThis.uid.includes("vizwiz");let T=E.get("quality_type");if(null==T&&(T="vf_contr_both"),!["vf_only","contr_only","vf_contr_both","single_numeric"].includes(T))throw new Error("Invalid quality type");let k=E.get("quality_format");if(null==k&&(k="numeric"),!["numeric","descriptive"].includes(k))throw new Error("Invalid quality format");globalThis.url_data.explanation_quality_params={quality_type:T,quality_format:k},console.log("Quality params",globalThis.url_data.explanation_quality_params),globalThis.url_data.session_id.startsWith("demo"),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((t=>{e=t,null!=q&&(n=parseInt(q)-1,console.log("Starting from",n)),p(0),$("#img_instr_1").attr("src",v("instructions_1")),$("#img_instr_2").attr("src",v("instructions_2")),$("#img_instr_3").attr("src",v("instructions_3")),$("#img_instr_4_vf_contr_both_numeric").attr("src",v("instructions_4_vf_contr_both_numeric")),$("#img_instr_4_vf_numeric").attr("src",v("instructions_4_vf_numeric")),$("#img_instr_4_contr_numeric").attr("src",v("instructions_4_contr_numeric")),$("#img_instr_4_single_numeric").attr("src",v("instructions_4_single_numeric")),$("#img_instr_4_vf_contr_both_descriptive").attr("src",v("instructions_4_vf_contr_both_descriptive")),$("#img_instr_4_vf_descriptive").attr("src",v("instructions_4_vf_descriptive")),$("#img_instr_4_contr_descriptive").attr("src",v("instructions_4_contr_descriptive")),function(){const t=document.getElementById("reward_instructions");t&&(t.innerHTML=`\n            If your final decision is correct, you gain a reward of $${.1.toFixed(2)}. \n            If your final decision is incorrect, you lose $${Math.abs(-.1).toFixed(2)} from your reward. \n            You will see your total reward at the end of the experiment. \n            Your payment is $2.0 plus whatever you accumulate during this experiment.\n        `)}(),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let A=!1;document.onvisibilitychange=()=>{A||(d+=1,A=!0,globalThis.uid.startsWith("demo")||alert("Please don't leave the page. If you do so again, we may restrict paying you."),A=!1)}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFpQm5ELElBR2pDMkIsRUFBa0IsR0FDbEJkLEVBQUUsZ0JBQWdCQyxLQUFLLE1BQU9TLEVBQVksbUJBQzFDVixFQUFFLGdCQUFnQkMsS0FBSyxNQUFPUyxFQUFZLG1CQUMxQ1YsRUFBRSxnQkFBZ0JDLEtBQUssTUFBT1MsRUFBWSxtQkFDMUNWLEVBQUUsc0NBQ0dDLEtBQUssTUFBT1MsRUFBWSx5Q0FDN0JWLEVBQUUsMkJBQ0dDLEtBQUssTUFBT1MsRUFBWSw4QkFDN0JWLEVBQUUsOEJBQ0dDLEtBQUssTUFBT1MsRUFBWSxpQ0FDN0JWLEVBQUUsK0JBQ0dDLEtBQUssTUFBT1MsRUFBWSxrQ0FDN0JWLEVBQUUsMENBQ0dDLEtBQUssTUFBT1MsRUFBWSw2Q0FDN0JWLEVBQUUsK0JBQ0dDLEtBQUssTUFBT1MsRUFBWSxrQ0FDN0JWLEVBQUUsa0NBQ0dDLEtBQUssTUFBT1MsRUFBWSxxQ0FsZmpDLFdBQ0ksTUFBTWlJLEVBQXFCaEgsU0FBU0MsZUFBZSx1QkFFL0MrRyxJQUNBQSxFQUFtQkMsVUFBWSwwRUN4R1QsR0R5R3dEM0QsUUFBUSxvRUFDakNILEtBQUsrRCxLQ3pHakMsSUR5R3dENUQsUUFBUSxvTUFPakcsQ0F1ZUk2RCxHQUNBOUksRUFBRSwwQkFBMEJFLE9BQzVCRixFQUFFLGlDQUFpQ2lCLE1BQU0sSUE2QjdDb0IsUUFBUUMsSUFBSSw2QkFBOEIxQixXQUFXMkIsS0FFckQsSUFBSXdHLEdBQWUsRUFDbkJwSCxTQUFTK0UsbUJBQXFCLEtBQ3JCcUMsSUFDRGxKLEdBQXFCLEVBQ3JCa0osR0FBZSxFQUNUbkksV0FBVzJCLElBQUt5RixXQUFXLFNBRTlCZ0IsTUFBTSxnRkFFVEQsR0FBZSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2Nvbm5lY3Rvci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZ2xvYmFscy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgREVWTU9ERSB9IGZyb20gJy4vZ2xvYmFscydcbmltcG9ydCB7IE1PQ0tNT0RFIH0gZnJvbSAnLi9tYWluJ1xuXG5sZXQgU0VSVkVSX0xPR19ST09UID0gREVWTU9ERSA/IFwiaHR0cDovLzEyNy4wLjAuMTo1MDAwL1wiIDogXCJodHRwczovL3RlamFzc3Jpbml2YXNhbi5weXRob25hbnl3aGVyZS5jb20vXCJcblxuYXN5bmMgZnVuY3Rpb24gc2xlZXAobXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZF9kYXRhKCk6IFByb21pc2U8YW55PiB7XG4gICAgLy8gaW5jbHVkZSB0aW1lc3RhbXAgc28gdGhhdCB0aGluZ3MgZG9uJ3QgZ2V0IGNhY2hlZFxuICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmdldEpTT04oXG4gICAgICAgIGBiYWtlZF9xdWV1ZXMvJHtnbG9iYWxUaGlzLnVpZH0uanNvbj90PSR7RGF0ZS5ub3coKX1gLFxuICAgIClcbiAgICByZXR1cm4gcmVzdWx0XG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nX2RhdGEoZGF0YSk6IFByb21pc2U8YW55PiB7XG4gICAgLy9pZiAoTU9DS01PREUpIHtcbiAgICAvLyAgICBjb25zb2xlLmxvZyhcImxvZ2dlZCAobW9jaylcIiwgZGF0YSlcbiAgICAvLyAgICByZXR1cm5cbiAgICAvL31cbiAgICBcbiAgICBkYXRhW1widXJsX2RhdGFcIl0gPSBnbG9iYWxUaGlzLnVybF9kYXRhXG4gICAgY29uc29sZS5sb2coXCJEYXRhXCIpXG4gICAgaWYgKCEoXCJzdHVkeV9pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XG4gICAgICAgIGRhdGFbJ3VybF9kYXRhJ11bXCJzdHVkeV9pZFwiXSA9IFwiZGVtb19zdHVkeVwiXG4gICAgfVxuICAgIGlmICghKFwicHJvbGlmaWNfaWRcIiBpbiBkYXRhWyd1cmxfZGF0YSddKSkge1xuICAgICAgICBkYXRhWyd1cmxfZGF0YSddW1wicHJvbGlmaWNfaWRcIl0gPSBcImRlbW9fdXNlclwiXG4gICAgfVxuICAgIGlmICghKFwic2Vzc2lvbl9pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XG4gICAgICAgIGRhdGFbJ3VybF9kYXRhJ11bXCJzZXNzaW9uX2lkXCJdID0gXCJkZW1vX3Nlc3Npb25cIlxuICAgIH1cbiAgICBkYXRhW1widXJsX2RhdGFcIl1bXCJxdWV1ZV9pZFwiXSA9IGdsb2JhbFRoaXMudWlkXG4gICAgY29uc29sZS5sb2coXCJsb2dnZWRcIiwgZGF0YSlcbiAgICBjb25zb2xlLmxvZyhcIkxvZ2dpbmcgdG9cIiwgU0VSVkVSX0xPR19ST09UICsgXCJsb2dcIilcblxuICAgIHRyeSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmFqYXgoXG4gICAgICAgICAgICBTRVJWRVJfTE9HX1JPT1QgKyBcImxvZ1wiLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdDogXCJ2bG0tcmF0aW9uYWxlcy1zdHVkeS9cIitkYXRhWyd1cmxfZGF0YSddWydzdHVkeV9pZCddLFxuICAgICAgICAgICAgICAgICAgICB1aWQ6IGdsb2JhbFRoaXMudWlkLnJlcGxhY2UoXCIvXCIsIFwiX1wiKSArIFwiX1wiICsgZGF0YVsndXJsX2RhdGEnXVsncHJvbGlmaWNfaWQnXSxcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZDogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgICAgYXdhaXQgc2xlZXAoMjAwMCk7XG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUpXG4gICAgfVxufSIsImltcG9ydCB7IERFVk1PREUsIFJFV0FSRF9DT1JSRUNULCBQRU5BTFRZX0lOQ09SUkVDVCwgRU5BQkxFX1RJTUVSIH0gZnJvbSBcIi4vZ2xvYmFsc1wiXG5leHBvcnQgdmFyIFVJRDogc3RyaW5nXG5leHBvcnQgdmFyIE1PQ0tNT0RFOiBib29sZWFuID0gZmFsc2VcbmltcG9ydCB7IGxvYWRfZGF0YSwgbG9nX2RhdGEgfSBmcm9tICcuL2Nvbm5lY3RvcidcbmltcG9ydCB7IHBhcmFtc1RvT2JqZWN0IH0gZnJvbSBcIi4vdXRpbHNcIlxuXG52YXIgZGF0YTogYW55W10gPSBbXVxubGV0IHF1ZXN0aW9uX2kgPSAtMVxubGV0IHF1ZXN0aW9uOiBhbnkgPSBudWxsXG5sZXQgdXNlcnNlbGVjdGlvbl9hbnN3ZXJvbmx5OiBudW1iZXIgPSAtMVxubGV0IHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uOiBudW1iZXIgPSAtMVxubGV0IHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eTogbnVtYmVyID0gLTFcbmxldCBudW1fY29ycmVjdCA9IDBcbmxldCBudW1faW5jb3JyZWN0ID0gMFxubGV0IG51bV91bnN1cmUgPSAwXG5cbmxldCBiYWxhbmNlID0gMFxuXG5sZXQgaW5zdHJ1Y3Rpb25faTogbnVtYmVyID0gMFxubGV0IGNvdW50X2V4aXRlZF9wYWdlOiBudW1iZXIgPSAwXG5cbmZ1bmN0aW9uIGFzc2VydChjb25kaXRpb24sIG1lc3NhZ2UpIHtcbiAgICBpZiAoIWNvbmRpdGlvbikge1xuICAgICAgICB0aHJvdyBtZXNzYWdlIHx8IFwiQXNzZXJ0aW9uIGZhaWxlZFwiO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbih1c2VyX2Nob2ljZTogbnVtYmVyKSB7XG4gICAgdXNlcnNlbGVjdGlvbl9hbnN3ZXJvbmx5ID0gdXNlcl9jaG9pY2VcblxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VyZGlzdHJ1c3RzXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ1bnN1cmVcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgIGlmICh1c2VyX2Nob2ljZSA9PSAwKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAxKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAyKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnVuc3VyZVwiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfVxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fZGl2XCIpLnNob3coKVxufVxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBidXR0b24gY2xpY2tcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fYW5zd2Vyb25seV91c2VydHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbigwKSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcmRpc3RydXN0cycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyQW5zd2VyT25seVVzZXJTZWxlY3Rpb24oMSkpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ1bnN1cmUnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlckFuc3dlck9ubHlVc2VyU2VsZWN0aW9uKDIpKTtcblxuXG5mdW5jdGlvbiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblVzZXJTZWxlY3Rpb24odXNlcl9jaG9pY2U6IG51bWJlcikge1xuICAgIHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uID0gdXNlcl9jaG9pY2VcblxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydHJ1c3RzXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ1bnN1cmVcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgIGlmICh1c2VyX2Nob2ljZSA9PSAwKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydHJ1c3RzXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICB9IGVsc2UgaWYgKHVzZXJfY2hvaWNlID09IDEpIHtcbiAgICAgICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMikge1xuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnVuc3VyZVwiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfVxuICAgIHNob3dRdWFsaXR5RGl2KClcbn1cblxuZnVuY3Rpb24gc2hvd1F1YWxpdHlEaXYoKSB7XG4gICAgaWYgKHF1YWxpdHlUeXBlID09IFwidmZfb25seVwiIHx8IHF1YWxpdHlUeXBlID09IFwidmZfY29udHJfYm90aFwiKSB7XG4gICAgICAgIGlmIChxdWFsaXR5Rm9ybWF0ID09IFwibnVtZXJpY1wiKSB7ICQoXCIjdmZfbnVtZXJpY19kaXZcIikuc2hvdygpIH1cbiAgICAgICAgaWYgKHF1YWxpdHlGb3JtYXQgPT0gXCJkZXNjcmlwdGl2ZVwiKSB7ICQoXCIjdmZfZGVzY3JpcHRpdmVfZGl2XCIpLnNob3coKSB9XG4gICAgfVxuICAgIGlmIChxdWFsaXR5VHlwZSA9PSBcImNvbnRyX29ubHlcIiB8fCBxdWFsaXR5VHlwZSA9PSBcInZmX2NvbnRyX2JvdGhcIikge1xuICAgICAgICBpZiAocXVhbGl0eUZvcm1hdCA9PSBcIm51bWVyaWNcIikgeyAkKFwiI2NvbnRyX251bWVyaWNfZGl2XCIpLnNob3coKSB9XG4gICAgICAgIGlmIChxdWFsaXR5Rm9ybWF0ID09IFwiZGVzY3JpcHRpdmVcIikgeyAkKFwiI2NvbnRyX2Rlc2NyaXB0aXZlX2RpdlwiKS5zaG93KCkgfVxuICAgIH1cbiAgICBpZiAocXVhbGl0eVR5cGUgPT0gXCJzaW5nbGVfbnVtZXJpY1wiKSB7XG4gICAgICAgIGFzc2VydCAocXVhbGl0eUZvcm1hdCA9PSBcIm51bWVyaWNcIiwgXCJxdWFsaXR5Rm9ybWF0IG11c3QgYmUgbnVtZXJpYyBmb3Igc2luZ2xlX251bWVyaWNcIilcbiAgICAgICAgJChcIiNzaW5nbGVfbnVtZXJpY19kaXZcIikuc2hvdygpXG4gICAgfVxufVxuXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25Vc2VyU2VsZWN0aW9uKDApKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHMnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblVzZXJTZWxlY3Rpb24oMSkpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnVuc3VyZScpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uVXNlclNlbGVjdGlvbigyKSk7XG4gIFxuZnVuY3Rpb24gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbih1c2VyX2Nob2ljZTogbnVtYmVyKSB7XG4gICAgdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5ID0gdXNlcl9jaG9pY2VcblxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VyZGlzdHJ1c3RzXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ1bnN1cmVcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgIGlmICh1c2VyX2Nob2ljZSA9PSAwKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAxKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAyKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnVuc3VyZVwiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfVxuICAgICQoXCIjYnV0dG9uX25leHRcIikuc2hvdygpXG4gICAgJChcIiNidXR0b25fbmV4dFwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbn1cblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ0cnVzdHMnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblF1YWxpdHlVc2VyU2VsZWN0aW9uKDApKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VyZGlzdHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbigxKSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnVuc3VyZScpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24oMikpO1xuXG5cbmZ1bmN0aW9uIHVwZGF0ZVJld2FyZEluc3RydWN0aW9ucygpIHtcbiAgICBjb25zdCByZXdhcmRJbnN0cnVjdGlvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV3YXJkX2luc3RydWN0aW9ucycpO1xuXG4gICAgaWYgKHJld2FyZEluc3RydWN0aW9ucykge1xuICAgICAgICByZXdhcmRJbnN0cnVjdGlvbnMuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgSWYgeW91ciBmaW5hbCBkZWNpc2lvbiBpcyBjb3JyZWN0LCB5b3UgZ2FpbiBhIHJld2FyZCBvZiAkJHtSRVdBUkRfQ09SUkVDVC50b0ZpeGVkKDIpfS4gXG4gICAgICAgICAgICBJZiB5b3VyIGZpbmFsIGRlY2lzaW9uIGlzIGluY29ycmVjdCwgeW91IGxvc2UgJCR7TWF0aC5hYnMoUEVOQUxUWV9JTkNPUlJFQ1QpLnRvRml4ZWQoMil9IGZyb20geW91ciByZXdhcmQuIFxuICAgICAgICAgICAgWW91IHdpbGwgc2VlIHlvdXIgdG90YWwgcmV3YXJkIGF0IHRoZSBlbmQgb2YgdGhlIGV4cGVyaW1lbnQuIFxuICAgICAgICAgICAgWW91ciBwYXltZW50IGlzICQyLjAgcGx1cyB3aGF0ZXZlciB5b3UgYWNjdW11bGF0ZSBkdXJpbmcgdGhpcyBleHBlcmltZW50LlxuICAgICAgICBgO1xuICAgICAgICAvLyBJZiB5b3VyIGZpbmFsIGRlY2lzaW9uIGlzIGNvcnJlY3QsIHlvdSBnYWluIGEgcmV3YXJkIG9mICQwLjEwLiBJZiB5b3VyIGZpbmFsIGRlY2lzaW9uIGlzIGluY29ycmVjdCwgeW91IGxvc2UgJDAuMTAgZnJvbSB5b3VyIHJld2FyZC5cbiAgICAgICAgLy8gWW91IHdpbGwgc2VlIHlvdXIgdG90YWwgcmV3YXJkIGF0IHRoZSBlbmQgb2YgdGhlIGV4cGVyaW1lbnQuIFlvdXIgcGF5bWVudCBpcyAkMi4wIHBsdXMgd2hhdGV2ZXIgeW91IGFjY3VtdWxhdGUgZHVyaW5nIHRoaXMgZXhwZXJpbWVudC5cbiAgICB9XG59XG5cbi8qKlxuICogUGljayB0aGUgY29ycmVjdCBpbnN0cnVjdGlvbiBpbWFnZS5cbiAqICAgaW1nL2luc3RydWN0aW9uc188aT4ucG5nICAgICAgICAgICAgICAoZGVmYXVsdClcbiAqICAgaW1nL2luc3RydWN0aW9uc188aT5fbm9fY2hvaWNlcy5wbmcgICAodml6d2l6IGV0Yy4pXG4gKi9cbmZ1bmN0aW9uIGdldEluc3RySW1nKGZpbGVTdGVtOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBnbG9iYWxUaGlzLm5vQ2hvaWNlc0RhdGFzZXRcbiAgICAgICAgPyBgaW1nLyR7ZmlsZVN0ZW19X25vX2Nob2ljZXMucG5nYFxuICAgICAgICA6IGBpbWcvJHtmaWxlU3RlbX0ucG5nYDtcbn1cblxuXG5mdW5jdGlvbiBuZXh0X2luc3RydWN0aW9ucyhpbmNyZW1lbnQ6IG51bWJlcikge1xuICAgIGluc3RydWN0aW9uX2kgKz0gaW5jcmVtZW50XG5cbiAgICBpZiAoaW5zdHJ1Y3Rpb25faSA9PSAwKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICB9IGVsc2Uge1xuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICB9XG4gICAgaWYgKGluc3RydWN0aW9uX2kgPj0gNSkge1xuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuc2hvdygpXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnZhbChcIlN0YXJ0IHN0dWR5XCIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLmhpZGUoKVxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS52YWwoXCJOZXh0XCIpXG4gICAgfVxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDYpIHtcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLnNob3coKVxuICAgICAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5oaWRlKClcbiAgICAgICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLnNob3coKVxuICAgICAgICBuZXh0X3F1ZXN0aW9uKClcbiAgICB9XG5cbiAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5jaGlsZHJlbihcIjpub3QoaW5wdXQpXCIpLmVhY2goKF8sIGVsKSA9PiB7XG4gICAgICAgICQoZWwpLmhpZGUoKVxuICAgIH0pXG4gICAgJChgI2luc3RydWN0aW9uc18ke2luc3RydWN0aW9uX2l9YCkuc2hvdygpXG4gICAgaWYgKGluc3RydWN0aW9uX2kgPT0gNCkge1xuICAgICAgICAkKFwiI2luc3RydWN0aW9uc180XCIpLmNoaWxkcmVuKFwiZGl2XCIpLmVhY2goKF8sIGVsKSA9PiB7ICQoZWwpLmhpZGUoKSAgfSlcbiAgICAgICAgaWYgKHF1YWxpdHlUeXBlID09IFwidmZfY29udHJfYm90aFwiICYmIHF1YWxpdHlGb3JtYXQgPT0gXCJudW1lcmljXCIpIHsgJChcIiNpbnN0cnVjdGlvbl92Zl9jb250cl9ib3RoX251bWVyaWNcIikuc2hvdygpIH1cbiAgICAgICAgaWYgKHF1YWxpdHlUeXBlID09IFwidmZfb25seVwiICYmIHF1YWxpdHlGb3JtYXQgPT0gXCJudW1lcmljXCIpIHsgJChcIiNpbnN0cnVjdGlvbl92Zl9udW1lcmljXCIpLnNob3coKSB9XG4gICAgICAgIGlmIChxdWFsaXR5VHlwZSA9PSBcImNvbnRyX29ubHlcIiAmJiBxdWFsaXR5Rm9ybWF0ID09IFwibnVtZXJpY1wiKSB7ICQoXCIjaW5zdHJ1Y3Rpb25fY29udHJfbnVtZXJpY1wiKS5zaG93KCkgfVxuICAgICAgICBpZiAocXVhbGl0eVR5cGUgPT0gXCJzaW5nbGVfbnVtZXJpY1wiICYmIHF1YWxpdHlGb3JtYXQgPT0gXCJudW1lcmljXCIpIHsgJChcIiNpbnN0cnVjdGlvbl9zaW5nbGVfbnVtZXJpY1wiKS5zaG93KCkgfVxuICAgICAgICBpZiAocXVhbGl0eVR5cGUgPT0gXCJ2Zl9jb250cl9ib3RoXCIgJiYgcXVhbGl0eUZvcm1hdCA9PSBcImRlc2NyaXB0aXZlXCIpIHsgJChcIiNpbnN0cnVjdGlvbl92Zl9jb250cl9ib3RoX2Rlc2NyaXB0aXZlXCIpLnNob3coKSB9XG4gICAgICAgIGlmIChxdWFsaXR5VHlwZSA9PSBcInZmX29ubHlcIiAmJiBxdWFsaXR5Rm9ybWF0ID09IFwiZGVzY3JpcHRpdmVcIikgeyAkKFwiI2luc3RydWN0aW9uX3ZmX2Rlc2NyaXB0aXZlXCIpLnNob3coKSB9XG4gICAgICAgIGlmIChxdWFsaXR5VHlwZSA9PSBcImNvbnRyX29ubHlcIiAmJiBxdWFsaXR5Rm9ybWF0ID09IFwiZGVzY3JpcHRpdmVcIikgeyAkKFwiI2luc3RydWN0aW9uX2NvbnRyX2Rlc2NyaXB0aXZlXCIpLnNob3coKSB9XG4gICAgfVxufVxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygrMSkpXG4kKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5vbihcImNsaWNrXCIsICgpID0+IG5leHRfaW5zdHJ1Y3Rpb25zKC0xKSlcblxuZnVuY3Rpb24gdXRpbGl0eV9vZl9zZWxlY3Rpb24oc2VsZWN0aW9uOiBudW1iZXIpIHtcbiAgICBsZXQgdXRpbGl0eTogbnVtYmVyID0gMFxuICAgIGlmIChzZWxlY3Rpb24gPT0gMikge1xuICAgICAgICB1dGlsaXR5ID0gMFxuICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBjb3JyZWN0X3NlbGVjdGlvbiA9IDEgLSBxdWVzdGlvbltcInByZWRpY3Rpb25faXNfY29ycmVjdFwiXSAvLyAwIGlmIEFJIGlzIGNvcnJlY3QsIDEgaWYgaW5jb3JyZWN0XG4gICAgICAgIHV0aWxpdHkgPSAoc2VsZWN0aW9uID09IGNvcnJlY3Rfc2VsZWN0aW9uKSA/IDEgOiAtMVxuICAgIH1cbiAgICByZXR1cm4gdXRpbGl0eVxufVxuXG4kKFwiI2J1dHRvbl9uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xuXG4gICAgLy8gVXBkYXRlIHRoZSB1c2VyIGJhbGFuY2VcbiAgICBsZXQgb2xkX2JhbGFuY2UgPSBiYWxhbmNlXG4gICAgdXBkYXRlX2JhbGFuY2UoKVxuXG4gICAgaWYgKHF1ZXN0aW9uX2kgIT0gLTEpIHtcbiAgICAgICAgbGV0IGxvZ2dlZF9kYXRhID0ge1xuICAgICAgICAgICAgXCJxdWVzdGlvbl9pXCI6IHF1ZXN0aW9uX2ksXG4gICAgICAgICAgICBcInVzZXJfc2VsZWN0aW9uc1wiOiB7XG4gICAgICAgICAgICAgICAgXCJhbnN3ZXJvbmx5XCI6IHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSxcbiAgICAgICAgICAgICAgICBcIndpdGhleHBsYW5hdGlvblwiOiB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbixcbiAgICAgICAgICAgICAgICBcIndpdGhleHBsYW5hdGlvbnF1YWxpdHlcIjogdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJ1c2VyX2lzX2NvcnJlY3RcIjoge1xuICAgICAgICAgICAgICAgIFwiYW5zd2Vyb25seVwiOiBpc191c2VyX2NvcnJlY3QodXNlcnNlbGVjdGlvbl9hbnN3ZXJvbmx5KSxcbiAgICAgICAgICAgICAgICBcIndpdGhleHBsYW5hdGlvblwiOiBpc191c2VyX2NvcnJlY3QodXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb24pLFxuICAgICAgICAgICAgICAgIFwid2l0aGV4cGxhbmF0aW9ucXVhbGl0eVwiOiBpc191c2VyX2NvcnJlY3QodXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5KVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwidXRpbGl0eV9vZl9leHBsYW5hdGlvblwiOiB1dGlsaXR5X29mX3NlbGVjdGlvbih1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbikgLSB1dGlsaXR5X29mX3NlbGVjdGlvbih1c2Vyc2VsZWN0aW9uX2Fuc3dlcm9ubHkpLFxuICAgICAgICAgICAgXCJ1dGlsaXR5X29mX3F1YWxpdHlfbWV0cmljc1wiOiB1dGlsaXR5X29mX3NlbGVjdGlvbih1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHkpIC0gdXRpbGl0eV9vZl9zZWxlY3Rpb24odXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb24pLFxuICAgICAgICAgICAgXCJiYWxhbmNlXCI6IHtcbiAgICAgICAgICAgICAgICBcIm9sZFwiOiBvbGRfYmFsYW5jZSxcbiAgICAgICAgICAgICAgICBcIm5ld1wiOiBiYWxhbmNlXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsb2dnZWRfZGF0YVsncXVlc3Rpb24nXSA9IHF1ZXN0aW9uXG4gICAgICAgIGxvZ2dlZF9kYXRhWydjb3VudF9leGl0ZWRfcGFnZSddID0gY291bnRfZXhpdGVkX3BhZ2VcbiAgICAgICAgbG9nX2RhdGEobG9nZ2VkX2RhdGEpXG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlID0gMFxuICAgIH1cbiAgICBcblxuICAgIG5leHRfcXVlc3Rpb24oKVxufSk7XG5cblxuZnVuY3Rpb24gaXNfdXNlcl9jb3JyZWN0KHNlbGVjdGlvbikge1xuICAgIGlmIChzZWxlY3Rpb24gIT0gMikge1xuICAgICAgICBsZXQgY29ycmVjdF9zZWxlY3Rpb24gPSAxIC0gcXVlc3Rpb25bXCJwcmVkaWN0aW9uX2lzX2NvcnJlY3RcIl0gLy8gMCBpZiBBSSBpcyBjb3JyZWN0LCAxIGlmIGluY29ycmVjdFxuICAgICAgICByZXR1cm4gc2VsZWN0aW9uID09IGNvcnJlY3Rfc2VsZWN0aW9uID8gMSA6IDBcbiAgICB9XG4gICAgcmV0dXJuIC0xXG59XG5cbmZ1bmN0aW9uIHVwZGF0ZV9iYWxhbmNlKCkge1xuICAgIGlmICh1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHkgIT0gMikge1xuICAgICAgICBsZXQgY29ycmVjdF9zZWxlY3Rpb24gPSAxIC0gcXVlc3Rpb25bXCJwcmVkaWN0aW9uX2lzX2NvcnJlY3RcIl0gLy8gMCBpZiBBSSBpcyBjb3JyZWN0LCAxIGlmIGluY29ycmVjdFxuICAgICAgICBpZiAodXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5ID09IGNvcnJlY3Rfc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBiYWxhbmNlICs9IFJFV0FSRF9DT1JSRUNUO1xuICAgICAgICAgICAgbnVtX2NvcnJlY3QgKz0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJhbGFuY2UgKz0gUEVOQUxUWV9JTkNPUlJFQ1Q7XG4gICAgICAgICAgICBudW1faW5jb3JyZWN0ICs9IDE7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBudW1fdW5zdXJlICs9IDE7XG4gICAgfVxufVxuXG4vLyBUbyBlbnN1cmUgYmFsYW5jZSBpcyBub24tbmVnYXRpdmVcbmZ1bmN0aW9uIGZpbmFsaXplX2JhbGFuY2UoKSB7XG4gICAgYmFsYW5jZSA9IE1hdGgubWF4KDAsIGJhbGFuY2UpO1xuICAgIHJldHVybiBiYWxhbmNlO1xufVxuXG5sZXQgYWN0aXZlVGltZXI6IFJldHVyblR5cGU8dHlwZW9mIHNldEludGVydmFsPiB8IG51bGwgPSBudWxsOyAvLyBUaW1lciBpbnRlcnZhbFxuXG5mdW5jdGlvbiBzdGFydFRpbWVyKGR1cmF0aW9uLCBzdGVwRGl2LCBidXR0b25zLCBjYWxsYmFjaykge1xuICAgIGlmICghRU5BQkxFX1RJTUVSKSB7XG4gICAgICAgIC8vIElmIHRoZSB0aW1lciBpcyBkaXNhYmxlZCwgZW5hYmxlIHRoZSBidXR0b25zIGltbWVkaWF0ZWx5XG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpKTtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjaygpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgYW55IGV4aXN0aW5nIHRpbWVyIHRvIHByZXZlbnQgbXVsdGlwbGUgaW50ZXJ2YWxzXG4gICAgaWYgKGFjdGl2ZVRpbWVyKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoYWN0aXZlVGltZXIpO1xuICAgICAgICBhY3RpdmVUaW1lciA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gRGlzYWJsZSBidXR0b25zXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpKTtcbiAgICBcbiAgICAvLyBTaG93IHRpbWVyIHZpc3VhbGx5XG4gICAgbGV0IHRpbWVyRGlzcGxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRpbWVyRGlzcGxheS5pZCA9IGB0aW1lcl8ke3N0ZXBEaXYuaWR9YDtcbiAgICB0aW1lckRpc3BsYXkuc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJztcbiAgICB0aW1lckRpc3BsYXkuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xuICAgIHN0ZXBEaXYuYXBwZW5kQ2hpbGQodGltZXJEaXNwbGF5KTtcblxuICAgIGxldCByZW1haW5pbmdUaW1lID0gZHVyYXRpb247XG5cbiAgICAvLyBJbml0aWFsIGRpc3BsYXlcbiAgICB0aW1lckRpc3BsYXkudGV4dENvbnRlbnQgPSBgUGxlYXNlIHdhaXQgJHtyZW1haW5pbmdUaW1lfSBzZWNvbmQocykgYmVmb3JlIG1ha2luZyB5b3VyIHNlbGVjdGlvbi5gO1xuXG4gICAgYWN0aXZlVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIHJlbWFpbmluZ1RpbWUtLTtcbiAgICAgICAgaWYgKHJlbWFpbmluZ1RpbWUgPj0gMCkge1xuICAgICAgICAgICAgdGltZXJEaXNwbGF5LnRleHRDb250ZW50ID0gYFBsZWFzZSB3YWl0ICR7cmVtYWluaW5nVGltZX0gc2Vjb25kKHMpIGJlZm9yZSBtYWtpbmcgeW91ciBzZWxlY3Rpb24uYDtcbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgaWYgKGFjdGl2ZVRpbWVyICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhY3RpdmVUaW1lcik7IC8vIFN0b3AgdGhlIHRpbWVyXG4gICAgICAgICAgICAgICAgYWN0aXZlVGltZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWN0aXZlVGltZXIgPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBSZW1vdmUgdGltZXIgZGlzcGxheVxuICAgICAgICAgICAgc3RlcERpdi5yZW1vdmVDaGlsZCh0aW1lckRpc3BsYXkpO1xuXG4gICAgICAgICAgICAvLyBFbmFibGUgYnV0dG9uc1xuICAgICAgICAgICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIikpO1xuXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICB9LCAxMDAwKTtcbn1cblxuLy8gV2hlbiB0aGUgdXNlciBzd2l0Y2hlcyB0YWJzIG9yIG1pbmltaXplcyB0aGUgd2luZG93LCBwYXVzZSB0aGUgdGltZXJcbmRvY3VtZW50Lm9udmlzaWJpbGl0eWNoYW5nZSA9ICgpID0+IHtcbiAgICBpZiAoZG9jdW1lbnQuaGlkZGVuKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiV2luZG93IGxvc3QgZm9jdXMuXCIpO1xuICAgICAgICBpZiAoYWN0aXZlVGltZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYWN0aXZlVGltZXIpOyAvLyBQYXVzZSB0aGUgdGltZXJcbiAgICAgICAgICAgIGFjdGl2ZVRpbWVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEhhbmRsZSBsb2dpYyB3aGVuIHRoZSB1c2VyIHJldHVybnNcbiAgICAgICAgY29uc29sZS5sb2coXCJXaW5kb3cgcmVnYWluZWQgZm9jdXMuXCIpO1xuICAgIH1cbn07XG5cbi8vIEZpcnN0IHN0ZXA6IGVuZm9yY2UgYSA1LXNlY29uZCB3YWl0XG5mdW5jdGlvbiBzZXR1cEZpcnN0U3RlcChleHBsYW5hdGlvblRleHQpIHtcbiAgICBjb25zdCBmaXJzdFN0ZXBEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWlfYW5zd2VyX2RpdicpO1xuICAgIGNvbnN0IGJ1dHRvbnMgPSBbXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fYW5zd2Vyb25seV91c2VydHJ1c3RzJyksXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fYW5zd2Vyb25seV91c2VyZGlzdHJ1c3RzJyksXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fYW5zd2Vyb25seV91c2VydW5zdXJlJylcbiAgICBdO1xuXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24/LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlRmlyc3RTdGVwQ2xpY2spKTsgLy8gUmVtb3ZlIG9sZCBsaXN0ZW5lcnNcbiAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVGaXJzdFN0ZXBDbGljaykpOyAvLyBBZGQgbmV3IG9uZXNcblxuICAgIGZ1bmN0aW9uIGhhbmRsZUZpcnN0U3RlcENsaWNrKCkge1xuICAgICAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbj8ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVGaXJzdFN0ZXBDbGljaykpOyAvLyBDbGVhbnVwXG4gICAgICAgIHNldHVwU2Vjb25kU3RlcChleHBsYW5hdGlvblRleHQpO1xuICAgIH1cblxuICAgICQoXCIjYWlfYW5zd2VyX2RpdlwiKS5zaG93KCk7XG4gICAgc3RhcnRUaW1lcig1LCBmaXJzdFN0ZXBEaXYsIGJ1dHRvbnMsIG51bGwpO1xuICAgIC8vICQoXCIjYWlfYW5zd2VyX2RpdlwiKS5zaG93KCk7IC8vIFNob3cgdGhlIGZpcnN0IHN0ZXBcbiAgICAvLyBzdGFydFRpbWVyKDUsIGZpcnN0U3RlcERpdiwgYnV0dG9ucywgKCkgPT4ge1xuICAgIC8vICAgICAvLyBCdXR0b25zIGFyZSBub3cgZW5hYmxlZDsgdXNlciBtdXN0IGNsaWNrIG9uZSB0byBwcm9jZWVkXG4gICAgLy8gICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xuICAgIC8vICAgICAgICAgYnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKFxuICAgIC8vICAgICAgICAgICAgICdjbGljaycsXG4gICAgLy8gICAgICAgICAgICAgKCkgPT4ge1xuICAgIC8vICAgICAgICAgICAgICAgICBzZXR1cFNlY29uZFN0ZXAoZXhwbGFuYXRpb25UZXh0KTsgLy8gUHJvY2VlZCB0byB0aGUgc2Vjb25kIHN0ZXAgYWZ0ZXIgYnV0dG9uIGNsaWNrXG4gICAgLy8gICAgICAgICAgICAgfSxcbiAgICAvLyAgICAgICAgICAgICB7IG9uY2U6IHRydWUgfSAvLyBFbnN1cmUgdGhlIGV2ZW50IGxpc3RlbmVyIGlzIGV4ZWN1dGVkIG9ubHkgb25jZVxuICAgIC8vICAgICAgICAgKTtcbiAgICAvLyAgICAgfSk7XG4gICAgLy8gfSk7XG59XG5cbi8vIFNlY29uZCBzdGVwIHRpbWVyIChkeW5hbWljIGJhc2VkIG9uIHJlYWRpbmcgdGltZSlcbmZ1bmN0aW9uIHNldHVwU2Vjb25kU3RlcChleHBsYW5hdGlvblRleHQpIHtcbiAgICBjb25zdCBzZWNvbmRTdGVwRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FpX2V4cGxhbmF0aW9uX2RpdicpO1xuICAgIGNvbnN0IHdvcmRzID0gZXhwbGFuYXRpb25UZXh0LnNwbGl0KCcgJykubGVuZ3RoO1xuICAgIGNvbnN0IHJlYWRpbmdUaW1lID0gTWF0aC5tYXgoTWF0aC5jZWlsKDMgKyAod29yZHMgLyAyMzgpICogNjApLCA1KTtcblxuICAgIGNvbnN0IGJ1dHRvbnMgPSBbXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ0cnVzdHMnKSxcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcmRpc3RydXN0cycpLFxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlJylcbiAgICBdO1xuXG4gICAgLy8gUmVtb3ZlIG9sZCBldmVudCBsaXN0ZW5lcnNcbiAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbj8ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVTZWNvbmRTdGVwQ2xpY2spKTtcblxuICAgIC8vIEFkZCBuZXcgZXZlbnQgbGlzdGVuZXJzXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlU2Vjb25kU3RlcENsaWNrKSk7XG5cbiAgICBmdW5jdGlvbiBoYW5kbGVTZWNvbmRTdGVwQ2xpY2soKSB7XG4gICAgICAgIC8vIENsZWFudXA6IHJlbW92ZSBldmVudCBsaXN0ZW5lcnNcbiAgICAgICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24/LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlU2Vjb25kU3RlcENsaWNrKSk7XG4gICAgICAgIHNldHVwVGhpcmRTdGVwKGV4cGxhbmF0aW9uVGV4dCk7XG4gICAgfVxuXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9kaXZcIikuc2hvdygpOyAvLyBTaG93IHRoZSBzZWNvbmQgc3RlcFxuICAgIHN0YXJ0VGltZXIocmVhZGluZ1RpbWUsIHNlY29uZFN0ZXBEaXYsIGJ1dHRvbnMsIG51bGwpOyAvLyBTdGFydCB0aW1lclxufVxuXG4vLyBUaGlyZCBzdGVwIHRpbWVyICg1IHNlY29uZHMpXG5mdW5jdGlvbiBzZXR1cFRoaXJkU3RlcChleHBsYW5hdGlvblRleHQpIHtcbiAgICBjb25zdCB0aGlyZFN0ZXBEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWlfZXhwbGFuYXRpb25fcXVhbGl0eV9kaXYnKTtcbiAgICBjb25zdCBidXR0b25zID0gW1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0cycpLFxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0cycpLFxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnVuc3VyZScpXG4gICAgXTtcblxuICAgIC8vIFJlbW92ZSBvbGQgZXZlbnQgbGlzdGVuZXJzXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24/LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlVGhpcmRTdGVwQ2xpY2spKTtcblxuICAgIC8vIEFkZCBuZXcgZXZlbnQgbGlzdGVuZXJzXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlVGhpcmRTdGVwQ2xpY2spKTtcblxuICAgIGZ1bmN0aW9uIGhhbmRsZVRoaXJkU3RlcENsaWNrKCkge1xuICAgICAgICAvLyBDbGVhbnVwOiByZW1vdmUgZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uPy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVRoaXJkU3RlcENsaWNrKSk7XG4gICAgICAgICQoXCIjYnV0dG9uX25leHRcIikuc2hvdygpOyAvLyBFbmFibGUgdGhlIG5leHQgcXVlc3Rpb24gYnV0dG9uXG4gICAgfVxuXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9xdWFsaXR5X2RpdlwiKS5zaG93KCk7IC8vIFNob3cgdGhlIHRoaXJkIHN0ZXBcbiAgICBzdGFydFRpbWVyKDUsIHRoaXJkU3RlcERpdiwgYnV0dG9ucywgbnVsbCk7IC8vIFN0YXJ0IHRpbWVyXG59XG5cbmZ1bmN0aW9uIG5leHRfcXVlc3Rpb24oKSB7XG4gICAgLy8gUmVzZXQgdGltZXJzIGFuZCBzdGF0ZVxuICAgIGlmIChhY3RpdmVUaW1lcikge1xuICAgICAgICBjbGVhckludGVydmFsKGFjdGl2ZVRpbWVyKTtcbiAgICAgICAgYWN0aXZlVGltZXIgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIHJlc3RvcmUgcHJldmlvdXMgc3RhdGUgb2YgVUlcbiAgICAkKFwiI2J1dHRvbl9yZWFkeXRvYW5zd2VyXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX3JlYWR5dG9hbnN3ZXJcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25fcmVhZHl0b2Fuc3dlclwiKS5zaG93KClcblxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ0cnVzdHNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VyZGlzdHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ1bnN1cmVcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ0cnVzdHNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ1bnN1cmVcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ1bnN1cmVcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG5cbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcblxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fZGl2XCIpLmhpZGUoKVxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fcXVhbGl0eV9kaXZcIikuaGlkZSgpXG4gICAgXG5cbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLmhpZGUoKVxuICAgICQoJyNidXR0b25fcXVpdCcpLmhpZGUoKVxuICAgIC8vJChcIiNyYW5nZV92YWxcIikudmFsKHVzZXJfdHJ1c3QpXG5cbiAgICBxdWVzdGlvbl9pICs9IDFcbiAgICBpZiAocXVlc3Rpb25faSA+PSBkYXRhLmxlbmd0aCkge1xuICAgICAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuaGlkZSgpXG4gICAgICAgIGJhbGFuY2UgPSBmaW5hbGl6ZV9iYWxhbmNlKClcblxuICAgICAgICBsZXQgcmV3YXJkX3RleHQgPSBgWW91ciB0b3RhbCByZXdhcmQgaXMgPGI+JCR7YmFsYW5jZS50b0ZpeGVkKDIpfSArICQyPC9iPi5gXG4gICAgICAgIHJld2FyZF90ZXh0ICs9IGA8YnI+WW91IGFuc3dlcmVkIGEgdG90YWwgb2YgJHtxdWVzdGlvbl9pfSBxdWVzdGlvbnM6ICR7bnVtX2NvcnJlY3R9IGNvcnJlY3QsICR7bnVtX2luY29ycmVjdH0gaW5jb3JyZWN0LCAke251bV91bnN1cmV9IHVuc3VyZS5gXG4gICAgICAgICQoJyNyZXdhcmRfYm94JykuaHRtbChyZXdhcmRfdGV4dClcbiAgICAgICAgJCgnI3Jld2FyZF9ib3gnKS5zaG93KClcbiAgICAgICAgJChcIiNtYWluX2JveF9lbmRcIikuc2hvdygpXG4gICAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHF1ZXN0aW9uID0gZGF0YVtxdWVzdGlvbl9pXVxuXG4gICAgY29uc3QgcXVlc3Rpb25UZXh0ID0gcXVlc3Rpb24hW1wicXVlc3Rpb25cIl07XG4gICAgY29uc3QgdXBkYXRlZFF1ZXN0aW9uVGV4dCA9IHF1ZXN0aW9uVGV4dC5yZXBsYWNlKFwiQ2hvaWNlczpcIiwgXCI8YnI+PGI+Q2hvaWNlczo8L2I+XCIpO1xuICAgICQoXCIjcXVlc3Rpb25fc3BhblwiKS5odG1sKHVwZGF0ZWRRdWVzdGlvblRleHQpO1xuXG4gICAgJChcIiNhaV9wcmVkaWN0aW9uX3NwYW5cIikuaHRtbChxdWVzdGlvbiFbXCJwcmVkaWN0ZWRfYW5zd2VyXCJdKVxuICAgICQoXCIjYWlfZXhwbGFuYXRpb25fc3BhblwiKS5odG1sKHF1ZXN0aW9uIVtcImdlbmVyYXRlZF9yYXRpb25hbGVcIl0pXG5cbiAgICBsZXQgdmlzdWFsX2ZpZGVsaXR5X2NvbmYgPSBNYXRoLnJvdW5kKHF1ZXN0aW9uIVtcInZpc3VhbF9maWRlbGl0eVwiXSAqIDEwMClcbiAgICAkKFwiI2V4cGxhbmF0aW9uX2ZpZGVsaXR5X251bWVyaWNfc3BhblwiKS5odG1sKGAke3Zpc3VhbF9maWRlbGl0eV9jb25mfSVgKVxuICAgIGxldCB2aXN1YWxfY29udHJhc3RpdmVuZXNzX2NvbmYgPSBNYXRoLnJvdW5kKHF1ZXN0aW9uIVtcImNvbnRyYXN0aXZlbmVzc1wiXSAqIDEwMClcbiAgICAkKFwiI2V4cGxhbmF0aW9uX2NvbnRyYXN0aXZlbmVzc19udW1lcmljX3NwYW5cIikuaHRtbChgJHt2aXN1YWxfY29udHJhc3RpdmVuZXNzX2NvbmZ9JWApXG4gICAgLy8gVGFrZSBwcm9kdWN0IG9mIHRoZSBhYm92ZSB0d29cbiAgICBsZXQgc2luZ2xlX251bWVyaWNfY29uZiA9IE1hdGgucm91bmQoKHF1ZXN0aW9uIVtcInZpc3VhbF9maWRlbGl0eVwiXSArIHF1ZXN0aW9uIVtcImNvbnRyYXN0aXZlbmVzc1wiXSkvMiAqIDEwMClcbiAgICAkKFwiI2V4cGxhbmF0aW9uX3NpbmdsZV9udW1lcmljX3NwYW5cIikuaHRtbChgJHtzaW5nbGVfbnVtZXJpY19jb25mfSVgKVxuICAgIC8vIFRPRE86IEZpbGwgaW4gdGhlIGRldGFpbHMgZm9yIHRoZSBkZXNjcmlwdGl2ZSBxdWFsaXRpZXNcblxuICAgIGxldCB2Zl9kZXNjcmlwdGl2ZSA9IFwiXCJcbiAgICBpZihxdWVzdGlvbltcInJlYXNvbl92Zl9jb3JyZWN0XCJdID09IFwiXCIpIHtcbiAgICAgICAgdmZfZGVzY3JpcHRpdmUgKz0gXCI8Yj5UaGVyZSBhcmUgbm8gZGV0YWlscyBhYm91dCB0aGUgaW1hZ2UgaW4gdGhlIGV4cGxhbmF0aW9uIHRoYXQgYXJlIGxpa2VseSBjb3JyZWN0LjwvYj5cIlxuICAgIH0gZWxzZSB7XG4gICAgICAgIHZmX2Rlc2NyaXB0aXZlICs9IFwiPGI+RGV0YWlscyBpbiB0aGUgZXhwbGFuYXRpb24gdGhhdCBhcmUgbGlrZWx5IGNvcnJlY3Q6PC9iPlwiXG4gICAgICAgIHZmX2Rlc2NyaXB0aXZlICs9IHF1ZXN0aW9uW1wicmVhc29uX3ZmX2NvcnJlY3RcIl0ucmVwbGFjZSgvPGJyPiAtL2csIFwiPGJyPiBcXHUyNzA1XCIpXG4gICAgfVxuICAgIGlmIChxdWVzdGlvbltcInJlYXNvbl92Zl9pbmNvcnJlY3RcIl0gPT0gXCJcIikge1xuICAgICAgICB2Zl9kZXNjcmlwdGl2ZSArPSBcIjxicj48YnI+PGI+VGhlcmUgYXJlIG5vIGRldGFpbHMgYWJvdXQgdGhlIGltYWdlIGluIHRoZSBleHBsYW5hdGlvbiB0aGF0IGFyZSBsaWtlbHkgaW5jb3JyZWN0LjwvYj5cIlxuICAgIH0gZWxzZSB7XG4gICAgICAgIHZmX2Rlc2NyaXB0aXZlICs9IFwiPGJyPjxicj48Yj5EZXRhaWxzIGluIHRoZSBleHBsYW5hdGlvbiB0aGF0IGFyZSBsaWtlbHkgTk9UIGNvcnJlY3Q6PC9iPlwiXG4gICAgICAgIHZmX2Rlc2NyaXB0aXZlICs9IHF1ZXN0aW9uW1wicmVhc29uX3ZmX2luY29ycmVjdFwiXS5yZXBsYWNlKC88YnI+IC0vZywgXCI8YnI+IFxcdTI3NGNcIilcbiAgICB9XG4gICAgJChcIiNleHBsYW5hdGlvbl9maWRlbGl0eV9kZXNjcmlwdGl2ZV9zcGFuXCIpLmh0bWwodmZfZGVzY3JpcHRpdmUpXG5cbiAgICBsZXQgY29udHJfZGVzY3JpcHRpdmUgPSBcIlwiXG4gICAgaWYocXVlc3Rpb25bXCJyZWFzb25fY29udHJcIl0gPT0gXCJcIikge1xuICAgICAgICBjb250cl9kZXNjcmlwdGl2ZSArPSBcIjxiPk5vbmUgb2YgdGhlIG90aGVyIGNob2ljZXMgYXJlIGxpa2VseSBjb3JyZWN0LCBiYXNlZCBvbiB0aGUgZXhwbGFuYXRpb24uPC9iPlwiXG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29udHJfZGVzY3JpcHRpdmUgKz0gXCI8Yj5PdGhlciBjaG9pY2VzIHRoYXQgY291bGQgYmUgY29ycmVjdCwgYmFzZWQgb24gdGhlIGV4cGxhbmF0aW9uOiA8L2I+XCJcbiAgICAgICAgY29udHJfZGVzY3JpcHRpdmUgKz0gcXVlc3Rpb25bXCJyZWFzb25fY29udHJcIl1cbiAgICB9XG4gICAgJChcIiNleHBsYW5hdGlvbl9jb250cmFzdGl2ZW5lc3NfZGVzY3JpcHRpdmVfc3BhblwiKS5odG1sKGNvbnRyX2Rlc2NyaXB0aXZlKVxuXG4gICAgLy90aW1lX3F1ZXN0aW9uX3N0YXJ0ID0gRGF0ZS5ub3coKVxuICAgICQoXCIjcHJvZ3Jlc3NcIikudGV4dChgUHJvZ3Jlc3M6ICR7cXVlc3Rpb25faSArIDF9IC8gJHtkYXRhLmxlbmd0aH1gKVxuXG4gICAgc2V0dXBGaXJzdFN0ZXAocXVlc3Rpb25bXCJnZW5lcmF0ZWRfcmF0aW9uYWxlXCJdKTtcbn1cblxuXG5cbi8vIGdldCB1c2VyIGlkIGFuZCBsb2FkIHF1ZXVlXG4vLyB0cnkgdG8gc2VlIGlmIHN0YXJ0IG92ZXJyaWRlIHdhcyBwYXNzZWRcbmNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XG5jb25zdCBzdGFydE92ZXJyaWRlID0gdXJsUGFyYW1zLmdldCgnc3RhcnQnKTtcbmNvbnN0IFVJREZyb21VUkwgPSB1cmxQYXJhbXMuZ2V0KFwidWlkXCIpXG5nbG9iYWxUaGlzLnVybF9kYXRhID0gcGFyYW1zVG9PYmplY3QodXJsUGFyYW1zLmVudHJpZXMoKSlcblxuaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3N0dWR5X2lkJ10gPT0gbnVsbCkge1xuICAgIGdsb2JhbFRoaXMudXJsX2RhdGFbJ3N0dWR5X2lkJ10gPSBcImRlbW9fc3R1ZHlcIlxufVxuaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Byb2xpZmljX2lkJ10gPT0gbnVsbCkge1xuICAgIGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Byb2xpZmljX2lkJ10gPSBcImRlbW9fdXNlclwiXG59XG5pZiAoZ2xvYmFsVGhpcy51cmxfZGF0YVsnc2Vzc2lvbl9pZCddID09IG51bGwpIHtcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydzZXNzaW9uX2lkJ10gPSBcImRlbW9fc2Vzc2lvblwiXG59XG5cbmlmIChVSURGcm9tVVJMICE9IG51bGwpIHtcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFVJREZyb21VUkwgYXMgc3RyaW5nXG4gICAgaWYgKGdsb2JhbFRoaXMudWlkID09IFwicHJvbGlmaWNfcmFuZG9tXCIpIHtcbiAgICAgICAgbGV0IHF1ZXVlX2lkID0gYCR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApfWAucGFkU3RhcnQoMywgXCIwXCIpXG4gICAgICAgIGdsb2JhbFRoaXMudWlkID0gYCR7dXJsUGFyYW1zLmdldChcInByb2xpZmljX3F1ZXVlX25hbWVcIil9LyR7cXVldWVfaWR9YFxuICAgIH1cbn0gZWxzZSBpZiAoREVWTU9ERSkge1xuICAgIGdsb2JhbFRoaXMudWlkID0gXCJkZW1vXCJcbn0gZWxzZSB7XG4gICAgbGV0IFVJRF9tYXliZTogYW55ID0gbnVsbFxuICAgIHdoaWxlIChVSURfbWF5YmUgPT0gbnVsbCkge1xuICAgICAgICBVSURfbWF5YmUgPSBwcm9tcHQoXCJFbnRlciB5b3VyIHVzZXIgaWQuIFBsZWFzZSBnZXQgaW4gdG91Y2ggaWYgeW91IHdlcmUgbm90IGFzc2lnbmVkIGFuIGlkIGJ1dCB3aXNoIHRvIHBhcnRpY2lwYXRlIGluIHRoaXMgZXhwZXJpbWVudC5cIilcbiAgICB9XG4gICAgZ2xvYmFsVGhpcy51aWQgPSBVSURfbWF5YmUhXG59XG5cbmdsb2JhbFRoaXMubm9DaG9pY2VzRGF0YXNldCA9IGdsb2JhbFRoaXMudWlkLmluY2x1ZGVzKFwidml6d2l6XCIpO1xuXG5cbmNvbnN0IHZhbGlkUXVhbGl0eVR5cGVzID0gW1widmZfb25seVwiLCBcImNvbnRyX29ubHlcIiwgXCJ2Zl9jb250cl9ib3RoXCIsIFwic2luZ2xlX251bWVyaWNcIl1cbmxldCBxdWFsaXR5VHlwZSA9IHVybFBhcmFtcy5nZXQoXCJxdWFsaXR5X3R5cGVcIilcbmlmIChxdWFsaXR5VHlwZSA9PSBudWxsKSB7IHF1YWxpdHlUeXBlID0gXCJ2Zl9jb250cl9ib3RoXCIgfVxuaWYgKCF2YWxpZFF1YWxpdHlUeXBlcy5pbmNsdWRlcyhxdWFsaXR5VHlwZSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHF1YWxpdHkgdHlwZVwiKVxufVxuXG5jb25zdCB2YWxpZFF1YWxpdHlGb3JtYXRzID0gW1wibnVtZXJpY1wiLCBcImRlc2NyaXB0aXZlXCJdXG5sZXQgcXVhbGl0eUZvcm1hdCA9IHVybFBhcmFtcy5nZXQoXCJxdWFsaXR5X2Zvcm1hdFwiKVxuaWYgKHF1YWxpdHlGb3JtYXQgPT0gbnVsbCkgeyBxdWFsaXR5Rm9ybWF0ID0gXCJudW1lcmljXCIgfVxuaWYgKCF2YWxpZFF1YWxpdHlGb3JtYXRzLmluY2x1ZGVzKHF1YWxpdHlGb3JtYXQpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBxdWFsaXR5IGZvcm1hdFwiKVxufVxuXG5nbG9iYWxUaGlzLnVybF9kYXRhW1wiZXhwbGFuYXRpb25fcXVhbGl0eV9wYXJhbXNcIl0gPSB7XG4gICAgXCJxdWFsaXR5X3R5cGVcIjogcXVhbGl0eVR5cGUsXG4gICAgXCJxdWFsaXR5X2Zvcm1hdFwiOiBxdWFsaXR5Rm9ybWF0XG59XG5jb25zb2xlLmxvZyhcIlF1YWxpdHkgcGFyYW1zXCIsIGdsb2JhbFRoaXMudXJsX2RhdGFbXCJleHBsYW5hdGlvbl9xdWFsaXR5X3BhcmFtc1wiXSlcblxuLy8gdmVyc2lvbiBmb3IgcGFwZXJcbmlmIChERVZNT0RFKSB7XG4gICAgTU9DS01PREUgPSB0cnVlXG59IGVsc2UgaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Nlc3Npb25faWQnXS5zdGFydHNXaXRoKFwiZGVtb1wiKSkge1xuICAgIE1PQ0tNT0RFID0gdHJ1ZVxufVxuXG5jb25zb2xlLmxvZyhcIlJ1bm5pbmcgd2l0aCBVSURcIiwgZ2xvYmFsVGhpcy51aWQpXG5sb2FkX2RhdGEoKS5jYXRjaCgoX2Vycm9yKSA9PiB7XG4gICAgLy9hbGVydChcIkludmFsaWQgdXNlciBpZC5cIilcbiAgICBjb25zb2xlLmxvZyhcIkludmFsaWQgdXNlciBpZC5cIilcbiAgICBjb25zb2xlLmxvZyhnbG9iYWxUaGlzLnVpZCEpXG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXG59XG4pLnRoZW4oKG5ld19kYXRhKSA9PiB7XG4gICAgZGF0YSA9IG5ld19kYXRhXG4gICAgaWYgKHN0YXJ0T3ZlcnJpZGUgIT0gbnVsbCkge1xuICAgICAgICBxdWVzdGlvbl9pID0gcGFyc2VJbnQoc3RhcnRPdmVycmlkZSkgLSAxXG4gICAgICAgIGNvbnNvbGUubG9nKFwiU3RhcnRpbmcgZnJvbVwiLCBxdWVzdGlvbl9pKVxuICAgIH1cbiAgICAvLyBuZXh0X3F1ZXN0aW9uKClcbiAgICBuZXh0X2luc3RydWN0aW9ucygwKVxuICAgICQoXCIjaW1nX2luc3RyXzFcIikuYXR0cihcInNyY1wiLCBnZXRJbnN0ckltZyhcImluc3RydWN0aW9uc18xXCIpKTtcbiAgICAkKFwiI2ltZ19pbnN0cl8yXCIpLmF0dHIoXCJzcmNcIiwgZ2V0SW5zdHJJbWcoXCJpbnN0cnVjdGlvbnNfMlwiKSk7XG4gICAgJChcIiNpbWdfaW5zdHJfM1wiKS5hdHRyKFwic3JjXCIsIGdldEluc3RySW1nKFwiaW5zdHJ1Y3Rpb25zXzNcIikpO1xuICAgICQoXCIjaW1nX2luc3RyXzRfdmZfY29udHJfYm90aF9udW1lcmljXCIpXG4gICAgICAgIC5hdHRyKFwic3JjXCIsIGdldEluc3RySW1nKFwiaW5zdHJ1Y3Rpb25zXzRfdmZfY29udHJfYm90aF9udW1lcmljXCIpKTtcbiAgICAkKFwiI2ltZ19pbnN0cl80X3ZmX251bWVyaWNcIilcbiAgICAgICAgLmF0dHIoXCJzcmNcIiwgZ2V0SW5zdHJJbWcoXCJpbnN0cnVjdGlvbnNfNF92Zl9udW1lcmljXCIpKTtcbiAgICAkKFwiI2ltZ19pbnN0cl80X2NvbnRyX251bWVyaWNcIilcbiAgICAgICAgLmF0dHIoXCJzcmNcIiwgZ2V0SW5zdHJJbWcoXCJpbnN0cnVjdGlvbnNfNF9jb250cl9udW1lcmljXCIpKTtcbiAgICAkKFwiI2ltZ19pbnN0cl80X3NpbmdsZV9udW1lcmljXCIpXG4gICAgICAgIC5hdHRyKFwic3JjXCIsIGdldEluc3RySW1nKFwiaW5zdHJ1Y3Rpb25zXzRfc2luZ2xlX251bWVyaWNcIikpO1xuICAgICQoXCIjaW1nX2luc3RyXzRfdmZfY29udHJfYm90aF9kZXNjcmlwdGl2ZVwiKVxuICAgICAgICAuYXR0cihcInNyY1wiLCBnZXRJbnN0ckltZyhcImluc3RydWN0aW9uc180X3ZmX2NvbnRyX2JvdGhfZGVzY3JpcHRpdmVcIikpO1xuICAgICQoXCIjaW1nX2luc3RyXzRfdmZfZGVzY3JpcHRpdmVcIilcbiAgICAgICAgLmF0dHIoXCJzcmNcIiwgZ2V0SW5zdHJJbWcoXCJpbnN0cnVjdGlvbnNfNF92Zl9kZXNjcmlwdGl2ZVwiKSk7XG4gICAgJChcIiNpbWdfaW5zdHJfNF9jb250cl9kZXNjcmlwdGl2ZVwiKVxuICAgICAgICAuYXR0cihcInNyY1wiLCBnZXRJbnN0ckltZyhcImluc3RydWN0aW9uc180X2NvbnRyX2Rlc2NyaXB0aXZlXCIpKTtcblxuICAgIHVwZGF0ZVJld2FyZEluc3RydWN0aW9ucygpO1xuICAgICQoXCIjbWFpbl9ib3hfaW5zdHJ1Y3Rpb25zXCIpLnNob3coKVxuICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5oaWRlKClcbn0pXG5cbi8vIC8vIER5bmFtaWNhbGx5IGxvYWQgZGF0YXNldCBiYXNlZCBvbiBEQVRBU0VUXG4vLyBmZXRjaChgLi9iYWtlZF9xdWV1ZXMvJHtEQVRBU0VUfWApXG4vLyAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuLy8gICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4vLyAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBkYXRhc2V0LlwiKTtcbi8vICAgICAgICAgfVxuLy8gICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuLy8gICAgIH0pXG4vLyAgICAgLnRoZW4oKG5ld19kYXRhKSA9PiB7XG4vLyAgICAgICAgIGRhdGEgPSBuZXdfZGF0YTtcbi8vICAgICAgICAgaWYgKHN0YXJ0T3ZlcnJpZGUgIT0gbnVsbCkge1xuLy8gICAgICAgICAgICAgcXVlc3Rpb25faSA9IHBhcnNlSW50KHN0YXJ0T3ZlcnJpZGUpIC0gMTtcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RhcnRpbmcgZnJvbVwiLCBxdWVzdGlvbl9pKTtcbi8vICAgICAgICAgfVxuLy8gICAgICAgICBuZXh0X2luc3RydWN0aW9ucygwKTtcbi8vICAgICAgICAgdXBkYXRlUmV3YXJkSW5zdHJ1Y3Rpb25zKCk7XG4vLyAgICAgICAgICQoXCIjbWFpbl9ib3hfaW5zdHJ1Y3Rpb25zXCIpLnNob3coKTtcbi8vICAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLmhpZGUoKTtcbi8vICAgICB9KVxuLy8gICAgIC5jYXRjaCgoX2Vycm9yKSA9PiB7XG4vLyAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJJbnZhbGlkIHVzZXIgaWQgb3IgZGF0YXNldCBsb2FkaW5nIGZhaWxlZC5cIik7XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKGdsb2JhbFRoaXMudWlkISk7XG4vLyAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbi8vICAgICB9KTtcblxuXG5jb25zb2xlLmxvZyhcIlN0YXJ0aW5nIHNlc3Npb24gd2l0aCBVSUQ6XCIsIGdsb2JhbFRoaXMudWlkISlcblxubGV0IGFsZXJ0X2FjdGl2ZSA9IGZhbHNlXG5kb2N1bWVudC5vbnZpc2liaWxpdHljaGFuZ2UgPSAoKSA9PiB7XG4gICAgaWYgKCFhbGVydF9hY3RpdmUpIHtcbiAgICAgICAgY291bnRfZXhpdGVkX3BhZ2UgKz0gMVxuICAgICAgICBhbGVydF9hY3RpdmUgPSB0cnVlXG4gICAgICAgIGlmICghKGdsb2JhbFRoaXMudWlkIS5zdGFydHNXaXRoKFwiZGVtb1wiKSkpIHtcbiAgICAgICAgICAgIC8vIHBhdXNlIHRoZSB0aW1lclxuICAgICAgICAgICBhbGVydChcIlBsZWFzZSBkb24ndCBsZWF2ZSB0aGUgcGFnZS4gSWYgeW91IGRvIHNvIGFnYWluLCB3ZSBtYXkgcmVzdHJpY3QgcGF5aW5nIHlvdS5cIilcbiAgICAgICAgfVxuICAgICAgICBhbGVydF9hY3RpdmUgPSBmYWxzZVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgICAvL2NvbnRpbnVlIHRoZSB0aW1lcj9cbiAgICB9XG59IiwiZGVjbGFyZSBsZXQgX0RFVk1PREU6IGJvb2xlYW5cblxuZXhwb3J0IHZhciBERVZNT0RFID0gX0RFVk1PREVcbmV4cG9ydCBjb25zdCBFTkFCTEVfVElNRVIgPSAhX0RFVk1PREU7ICAvLyBTZXQgdG8gYGZhbHNlYCB0byBkaXNhYmxlIHRoZSB0aW1lciBmb3IgZGVidWdnaW5nXG5cbmV4cG9ydCBjb25zdCBSRVdBUkRfQ09SUkVDVCA9IDAuMTsgLy8gUmV3YXJkIGZvciBhIGNvcnJlY3QgYW5zd2VyXG5leHBvcnQgY29uc3QgUEVOQUxUWV9JTkNPUlJFQ1QgPSAtMC4xOyAvLyBQZW5hbHR5IGZvciBhbiBpbmNvcnJlY3QgYW5zd2VyIiwiZnVuY3Rpb24gcGFyYW1zVG9PYmplY3QoZW50cmllcykge1xuICBjb25zdCByZXN1bHQgPSB7fVxuICAvLyBlYWNoICdlbnRyeScgaXMgYSBba2V5LCB2YWx1ZV0gdHVwcGxlXG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIGVudHJpZXMpIHtcbiAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCB7IHBhcmFtc1RvT2JqZWN0IH0iXSwibmFtZXMiOlsiU0VSVkVSX0xPR19ST09UIiwiZGF0YSIsInF1ZXN0aW9uX2kiLCJxdWVzdGlvbiIsInVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSIsInVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uIiwidXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5IiwibnVtX2NvcnJlY3QiLCJudW1faW5jb3JyZWN0IiwibnVtX3Vuc3VyZSIsImJhbGFuY2UiLCJpbnN0cnVjdGlvbl9pIiwiY291bnRfZXhpdGVkX3BhZ2UiLCJyZWdpc3RlckFuc3dlck9ubHlVc2VyU2VsZWN0aW9uIiwidXNlcl9jaG9pY2UiLCIkIiwiYXR0ciIsInNob3ciLCJyZWdpc3RlcldpdGhFeHBsYW5hdGlvblVzZXJTZWxlY3Rpb24iLCJxdWFsaXR5VHlwZSIsInF1YWxpdHlGb3JtYXQiLCJjb25kaXRpb24iLCJhc3NlcnQiLCJyZWdpc3RlcldpdGhFeHBsYW5hdGlvblF1YWxpdHlVc2VyU2VsZWN0aW9uIiwicmVtb3ZlQXR0ciIsImdldEluc3RySW1nIiwiZmlsZVN0ZW0iLCJnbG9iYWxUaGlzIiwibm9DaG9pY2VzRGF0YXNldCIsIm5leHRfaW5zdHJ1Y3Rpb25zIiwiaW5jcmVtZW50IiwidmFsIiwiaGlkZSIsIm5leHRfcXVlc3Rpb24iLCJjaGlsZHJlbiIsImVhY2giLCJfIiwiZWwiLCJ1dGlsaXR5X29mX3NlbGVjdGlvbiIsInNlbGVjdGlvbiIsInV0aWxpdHkiLCJpc191c2VyX2NvcnJlY3QiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uIiwib2xkX2JhbGFuY2UiLCJjb3JyZWN0X3NlbGVjdGlvbiIsInVwZGF0ZV9iYWxhbmNlIiwibG9nZ2VkX2RhdGEiLCJhc3luYyIsInVybF9kYXRhIiwiY29uc29sZSIsImxvZyIsInVpZCIsInJlc3VsdCIsImFqYXgiLCJKU09OIiwic3RyaW5naWZ5IiwicHJvamVjdCIsInJlcGxhY2UiLCJwYXlsb2FkIiwidHlwZSIsImNvbnRlbnRUeXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Iiwic2xlZXAiLCJlIiwibG9nX2RhdGEiLCJhY3RpdmVUaW1lciIsInN0YXJ0VGltZXIiLCJkdXJhdGlvbiIsInN0ZXBEaXYiLCJidXR0b25zIiwiY2FsbGJhY2siLCJjbGVhckludGVydmFsIiwiZm9yRWFjaCIsImJ1dHRvbiIsInNldEF0dHJpYnV0ZSIsInRpbWVyRGlzcGxheSIsImNyZWF0ZUVsZW1lbnQiLCJpZCIsInN0eWxlIiwiZm9udFdlaWdodCIsIm1hcmdpblRvcCIsImFwcGVuZENoaWxkIiwicmVtYWluaW5nVGltZSIsInRleHRDb250ZW50Iiwic2V0SW50ZXJ2YWwiLCJyZW1vdmVDaGlsZCIsInJlbW92ZUF0dHJpYnV0ZSIsImxlbmd0aCIsIk1hdGgiLCJtYXgiLCJyZXdhcmRfdGV4dCIsInRvRml4ZWQiLCJodG1sIiwidXBkYXRlZFF1ZXN0aW9uVGV4dCIsInZpc3VhbF9maWRlbGl0eV9jb25mIiwicm91bmQiLCJ2aXN1YWxfY29udHJhc3RpdmVuZXNzX2NvbmYiLCJzaW5nbGVfbnVtZXJpY19jb25mIiwidmZfZGVzY3JpcHRpdmUiLCJjb250cl9kZXNjcmlwdGl2ZSIsInRleHQiLCJleHBsYW5hdGlvblRleHQiLCJmaXJzdFN0ZXBEaXYiLCJoYW5kbGVGaXJzdFN0ZXBDbGljayIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZWNvbmRTdGVwRGl2Iiwid29yZHMiLCJzcGxpdCIsInJlYWRpbmdUaW1lIiwiY2VpbCIsImhhbmRsZVNlY29uZFN0ZXBDbGljayIsInRoaXJkU3RlcERpdiIsImhhbmRsZVRoaXJkU3RlcENsaWNrIiwic2V0dXBUaGlyZFN0ZXAiLCJzZXR1cFNlY29uZFN0ZXAiLCJzZXR1cEZpcnN0U3RlcCIsIm9udmlzaWJpbGl0eWNoYW5nZSIsImhpZGRlbiIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsIndpbmRvdyIsImxvY2F0aW9uIiwic2VhcmNoIiwic3RhcnRPdmVycmlkZSIsImdldCIsIlVJREZyb21VUkwiLCJlbnRyaWVzIiwia2V5IiwidmFsdWUiLCJwYXJhbXNUb09iamVjdCIsInF1ZXVlX2lkIiwiZmxvb3IiLCJyYW5kb20iLCJwYWRTdGFydCIsIlVJRF9tYXliZSIsInByb21wdCIsImluY2x1ZGVzIiwiRXJyb3IiLCJzdGFydHNXaXRoIiwiZ2V0SlNPTiIsIkRhdGUiLCJub3ciLCJsb2FkX2RhdGEiLCJjYXRjaCIsIl9lcnJvciIsInJlbG9hZCIsInRoZW4iLCJuZXdfZGF0YSIsInBhcnNlSW50IiwicmV3YXJkSW5zdHJ1Y3Rpb25zIiwiaW5uZXJIVE1MIiwiYWJzIiwidXBkYXRlUmV3YXJkSW5zdHJ1Y3Rpb25zIiwiYWxlcnRfYWN0aXZlIiwiYWxlcnQiXSwic291cmNlUm9vdCI6IiJ9